# æ¸è¿›å¼é•¿ç¯‡å°è¯´åˆ›ä½œç³»ç»Ÿ - å®Œæ•´æ–¹æ¡ˆ

## ä¸€ã€é¡¹ç›®èƒŒæ™¯

### 1.1 éœ€æ±‚æ¥æº

åŸºäºã€Šæˆ‘åœ¨éƒ½å¸‚ä¿®ä»™ï¼Œå¤ªç²¾å½©äº†ã€‹è¿›è¡ŒäºŒåˆ›ï¼Œåˆ›ä½œ100ä¸‡å­—é•¿ç¯‡å°è¯´ï¼Œé¢ä¸´ä»¥ä¸‹æŒ‘æˆ˜ï¼š

- **å¤æ‚è®¾å®šä¼—å¤š**ï¼šå‡ åä¸ªä¿®ä»™é—¨æ´¾ï¼ˆå„æœ‰å†…æ ¸ï¼‰ã€ä¸Šç™¾ä¸ªäººç‰©ï¼ˆä¸»è§’å›¢+é…è§’+åæ´¾ï¼‰ã€å¤æ‚çš„ä¼ç¬”ç½‘ç»œ
- **è´¨é‡è¦æ±‚é«˜**ï¼šä¸»è§’å†…æ ¸è¦ç¨³ã€é—¨æ´¾å†…æ ¸è¦ç«™ä½è„šã€äººç‰©æˆé•¿è¦æœ‰å¼§å…‰
- **åˆ›ä½œå‘¨æœŸé•¿**ï¼šä¸å¯èƒ½ä¸€æ¬¡å†™å®Œï¼Œéœ€è¦åˆ†å¤šæ¬¡ç»­å†™
- **ä¸€è‡´æ€§éš¾ä¿è¯**ï¼šäººç‰©æ€§æ ¼ã€ä¸–ç•Œè§‚è§„åˆ™ã€ä¼ç¬”åŸ‹æ”¶å®¹æ˜“å‰åçŸ›ç›¾

### 1.2 ç°æœ‰ç³»ç»Ÿé—®é¢˜

- ç¼ºå°‘æ–­ç‚¹ç»­å†™åŠŸèƒ½
- è´¨é‡è¯„ä¼°å¤±è´¥åæ²¡æœ‰é‡å†™æœºåˆ¶
- å‰ç«¯ä¸æ”¯æŒé•¿æœŸåˆ›ä½œçš„ç®¡ç†éœ€æ±‚
- æ¸è¿›å¼æ„å»ºæµç¨‹æœªå®ç°

---

## äºŒã€æ ¸å¿ƒæ–¹æ¡ˆæ¦‚è§ˆ

### 2.1 è®¾è®¡ç†å¿µ

**æ¸è¿›å¼æ„å»º + ç³»ç»Ÿä¿è¯è´¨é‡ + éšæ—¶æ–­ç‚¹ç»­å†™**

- å¤§çº²ç˜¦èº«ï¼šåªå†™æ ¸å¿ƒæ¡†æ¶ï¼Œå…·ä½“è®¾å®šå¤–ç½®
- è®¾å®šåˆ†ç¦»ï¼šé—¨æ´¾ã€äººç‰©ã€ä¼ç¬”ç”±æ’ä»¶ç‹¬ç«‹ç®¡ç†
- è‡ªåŠ¨è¡”æ¥ï¼šç³»ç»Ÿè‡ªåŠ¨æ£€ç´¢ç›¸å…³ä¸Šä¸‹æ–‡
- è´¨é‡é—¨æ§ï¼šå¤šç»´åº¦è¯„ä¼°ï¼Œä¸é€šè¿‡è‡ªåŠ¨é‡å†™
- æ–­ç‚¹ç»­å†™ï¼šä¿å­˜å®Œæ•´çŠ¶æ€ï¼Œéšæ—¶ç»§ç»­

### 2.2 å®é™…åˆ›ä½œæµç¨‹

```
é˜¶æ®µ0ï¼šåˆ›æ„è„‘æš´
â””â”€ åˆ›æ„è„‘æš´ï¼šäº§ç”Ÿ3-5ä¸ªæ•…äº‹ç‚¹å­

é˜¶æ®µ1ï¼šæ ¸å¿ƒæ¡†æ¶
â””â”€ å¤§çº²ï¼šå®Œæ•´æ•…äº‹å¤§çº²ï¼ˆåŒ…å«äº‹ä»¶ã€ä¼ç¬”ã€ç« èŠ‚è§„åˆ’ï¼‰

é˜¶æ®µ2ï¼šåŸºç¡€å…ƒç´ è®¾è®¡
â”œâ”€ ä¸–ç•Œè§‚è§„åˆ™ï¼šä¸–ç•Œè¿ä½œçš„æ ¸å¿ƒè§„åˆ™ã€é™åˆ¶å’Œå¯èƒ½æ€§
â””â”€ åŠ¿åŠ›è®¾è®¡ï¼šå„å¤§é—¨æ´¾ã€å®¶æ—ã€ç»„ç»‡ï¼ˆä¿¡ä»°ã€ç›®æ ‡ã€èƒ½åŠ›ã€äººå‘˜ã€åœ°ç›˜ï¼‰

é˜¶æ®µ3ï¼šè¯¦ç»†å…ƒç´ è®¾è®¡
â”œâ”€ åœºæ™¯è®¾è®¡ï¼šç§˜å¢ƒã€ç¦åœ°ã€é—è¿¹ã€æ´åºœç­‰åœ°ç‚¹è¯¦ç»†è®¾å®š
â”œâ”€ äººç‰©è®¾è®¡ï¼šè§’è‰²æ¡£æ¡ˆã€å…³ç³»ã€æˆé•¿å¼§çº¿
â”œâ”€ åŠŸæ³•æ³•å®ï¼šåŠŸæ³•ç­‰çº§ã€æ•ˆæœã€ä¿®ç‚¼æ¡ä»¶ï¼›æ³•å®æ¥å†ã€èƒ½åŠ›ã€å™¨çµ
â””â”€ ä¸»è§’æˆé•¿ï¼šå¢ƒç•Œåˆ’åˆ†ã€çªç ´æ¡ä»¶ã€æ ¸å¿ƒåŠŸæ³•å‡çº§è·¯å¾„ã€é¡¿æ‚Ÿæ—¶åˆ»

é˜¶æ®µ4ï¼šå¯¹æ‰‹ä¸äº‹ä»¶è§„åˆ’
â”œâ”€ åæ´¾è®¾è®¡ï¼šç»ˆæåæ´¾ã€ä¸­æœŸåæ´¾ã€é˜¶æ®µæ€§å¯¹æ‰‹
â”œâ”€ äº‹ä»¶ï¼šè¯¦ç»†è§„åˆ’æ¯ä¸ªå…³é”®äº‹ä»¶ï¼ˆç« èŠ‚ã€äººç‰©ã€èµ·å› ã€ç»è¿‡ã€ç»“æœï¼‰
â””â”€ æ—¶é—´çº¿ï¼šäº‹ä»¶æ—¶é—´é¡ºåºã€äººç‰©å¹´é¾„å˜åŒ–ã€ä¿®ä¸ºæå‡æ—¶é—´è·¨åº¦

é˜¶æ®µ5ï¼šä¼ç¬”ç®¡ç†
â””â”€ ä¼ç¬”åˆ—è¡¨ï¼šç³»ç»ŸåŒ–ç®¡ç†æ‰€æœ‰ä¼ç¬”ï¼ˆåç§°ã€åŸ‹è®¾ç« èŠ‚ã€å›æ”¶ç« èŠ‚ï¼‰

é˜¶æ®µ5.5ï¼šæ•…äº‹å•å…ƒè§„åˆ’ï¼ˆé’ˆå¯¹é•¿ç¯‡çš„æ¨¡å—åŒ–è§„åˆ’ï¼‰
â”œâ”€ å•å…ƒ1è§„åˆ’ï¼šç¬¬1-100ç« è¯¦ç»†å‰§æƒ…ï¼ˆæ–°æ‰‹æ‘ç¯‡ï¼‰
â”œâ”€ å•å…ƒ2è§„åˆ’ï¼šç¬¬101-200ç« è¯¦ç»†å‰§æƒ…ï¼ˆå®—é—¨ç¯‡ï¼‰
â”œâ”€ å•å…ƒ3è§„åˆ’ï¼šç¬¬201-300ç« è¯¦ç»†å‰§æƒ…ï¼ˆå·åŸç¯‡ï¼‰
â””â”€ ...ï¼ˆæ¯100ç« ä¸€ä¸ªç‹¬ç«‹å•å…ƒè§„åˆ’ï¼‰

é˜¶æ®µ6ï¼šé€ç« ç”Ÿæˆ
â””â”€ ç« èŠ‚å†…å®¹ï¼šé€ç« ç”Ÿæˆé«˜è´¨é‡å†…å®¹ï¼ˆæ¯ç« ä¾èµ–å‰ä¸€ç« å’Œæ‰€å±å•å…ƒè§„åˆ’ï¼‰

é˜¶æ®µ7ï¼šè´¨é‡æ£€æŸ¥ï¼ˆæ¯ç« åè‡ªåŠ¨è¿è¡Œï¼‰
â”œâ”€ ä¸€è‡´æ€§æ£€æŸ¥ï¼šæ£€æŸ¥äººç‰©ã€ä¸–ç•Œè§‚ã€æ—¶é—´çº¿ä¸€è‡´æ€§
â””â”€ å¯¹è¯æ£€æŸ¥ï¼šæ£€æŸ¥è§’è‰²å¯¹è¯é£æ ¼ä¸€è‡´æ€§
```

**æ³¨**ï¼šç³»ç»Ÿå½“å‰å·²å®ç°çš„å®Œæ•´ä»»åŠ¡æµç¨‹ä¸ºï¼ˆ14ä¸ªä»»åŠ¡ï¼‰ï¼š
```
åˆ›æ„è„‘æš´ â†’ å¤§çº² â†’ ä¸–ç•Œè§‚è§„åˆ™ â†’ åŠ¿åŠ›è®¾è®¡ â†’ åœºæ™¯è®¾è®¡ â†’ äººç‰©è®¾è®¡ â†’
åŠŸæ³•æ³•å® â†’ ä¸»è§’æˆé•¿ â†’ åæ´¾è®¾è®¡ â†’ äº‹ä»¶ â†’ æ—¶é—´çº¿ â†’ ä¼ç¬”åˆ—è¡¨ â†’
æ•…äº‹å•å…ƒè§„åˆ’ â†’ ç« èŠ‚å†…å®¹ â†’ ä¸€è‡´æ€§æ£€æŸ¥/å¯¹è¯æ£€æŸ¥
```

**æ³¨**ï¼šé’ˆå¯¹1000ç« é•¿ç¯‡å°è¯´ï¼Œé‡‡ç”¨ã€Œæ— é™é‡å¤çš„æ¨¡å—åŒ–ä¸‰å¹•ç»“æ„ã€ï¼š
- å°†1000ç« åˆ†æˆ10ä¸ªæ•…äº‹å•å…ƒï¼ˆæ¯å•å…ƒ100ç« ï¼‰
- æ¯ä¸ªå•å…ƒå†…éƒ¨ä½¿ç”¨å®Œæ•´ä¸‰å¹•ç»“æ„ï¼ˆ20%-60%-20%ï¼‰
- å•å…ƒä¹‹é—´é€šè¿‡ã€Œæ¢åœ°å›¾/å‡çº§ã€è‡ªç„¶è¡”æ¥
- æ¯ä¸ªå•å…ƒæœ‰ç‹¬ç«‹çš„è¯¦ç»†è§„åˆ’ï¼ˆå‰§æƒ…ã€äººç‰©ã€ä¼ç¬”ï¼‰

---

## ä¸‰ã€è¯¦ç»†åŠŸèƒ½è®¾è®¡

### 3.1 æ¸è¿›å¼æ„å»ºæµç¨‹

#### 3.1.1 å¤§çº²ç²¾ç®€ç­–ç•¥

**ä¼ ç»Ÿå¤§çº²é—®é¢˜**ï¼š
- åŒ…å«æ‰€æœ‰é—¨æ´¾è®¾å®š â†’ 3ä¸‡å­—
- åŒ…å«æ‰€æœ‰äººç‰©å°ä¼  â†’ 5ä¸‡å­—
- åŒ…å«æ‰€æœ‰ä¼ç¬”ç»†èŠ‚ â†’ 2ä¸‡å­—
- æ€»è®¡10ä¸‡å­—ï¼Œè‡ƒè‚¿ä¸”éš¾ä»¥ä¿®æ”¹

**æ–°å¤§çº²ç­–ç•¥**ï¼ˆ5åƒå­—ï¼‰ï¼š
```json
{
  "æ•…äº‹æ ¸å¿ƒ": "ä¸€å¥è¯æ¦‚æ‹¬",
  "ä¸»è§’å†…æ ¸": {
    "æ ¸å¿ƒç›®æ ‡": "æˆä¸ºä¿®ä»™ç•Œæœ€å¼ºï¼Œä¿æŠ¤æ‰€çˆ±ä¹‹äºº",
    "æ ¸å¿ƒææƒ§": "å¤±å»äº²äºº",
    "æ ¸å¿ƒæ¬²æœ›": "è·å¾—è®¤å¯",
    "æ€§æ ¼å†…æ ¸": "åšéŸ§ã€é‡æƒ…ã€æ™ºå‹‡åŒå…¨"
  },
  "æ ¸å¿ƒé—¨æ´¾": [
    {"åç§°": "é’ç„å®—", "å†…æ ¸": "ä»¥å¾·æœäºº", "ä¸ä¸»è§’å…³ç³»": "å¸ˆé—¨"},
    {"åç§°": "é­”é—¨", "å†…æ ¸": "å¼±è‚‰å¼ºé£Ÿ", "ä¸ä¸»è§’å…³ç³»": "æ•Œå¯¹"}
  ],
  "ä¸»è§’å›¢": [
    {"å§“å": "å¼ ä¸‰", "å†…æ ¸": "å¿ è¯š", "ä½œç”¨": "æ­¦åŠ›æ‹…å½“"},
    {"å§“å": "æå››", "å†…æ ¸": "æ™ºæ…§", "ä½œç”¨": "æ™ºå›Š"}
  ],
  "ä¸»çº¿ä¼ç¬”": [
    {"åç§°": "èº«ä¸–ä¹‹è°œ", "åŸ‹è®¾ç« èŠ‚": 1, "å›æ”¶ç« èŠ‚": 50},
    {"åç§°": "ç¥å™¨çº¿ç´¢", "åŸ‹è®¾ç« èŠ‚": 5, "å›æ”¶ç« èŠ‚": 80}
  ],
  "ç« èŠ‚éª¨æ¶": [
    {"ç« èŠ‚": 1, "ä¸€å¥è¯æ¢—æ¦‚": "ä¸»è§’ç©¿è¶Šï¼Œå‘ç°è‡ªå·±åœ¨ä¿®ä»™ä¸–ç•Œ"},
    {"ç« èŠ‚": 2, "ä¸€å¥è¯æ¢—æ¦‚": "ä¸»è§’è¢«é’ç„å®—æ”¶ç•™"}
  ]
}
```

#### 3.1.2 è®¾å®šå¤–ç½®ç®¡ç†

**æ’ä»¶ç³»ç»Ÿç®¡ç†**ï¼š
- `CharacterPlugin`ï¼šç®¡ç†æ‰€æœ‰äººç‰©çš„è¯¦ç»†è®¾å®š
- `WorldViewPlugin`ï¼šç®¡ç†ä¸–ç•Œè§‚ã€é—¨æ´¾è®¾å®š
- `ForeshadowPlugin`ï¼šç®¡ç†ä¼ç¬”è¿½è¸ª
- `EventPlugin`ï¼šç®¡ç†äº‹ä»¶é“¾

**æ•°æ®æµ**ï¼š
```
å¤§çº² â†’ ä¸»è§’ï¼š"ææ˜ï¼Œæ€§æ ¼åšéŸ§"
      â†“
äººç‰©è®¾è®¡ â†’ å®Œæ•´æ¡£æ¡ˆï¼š
          {
            "å§“å": "ææ˜",
            "æ€§æ ¼": {"traits": ["åšéŸ§", "é‡æƒ…", "èªæ˜"], ...},
            "èƒŒæ™¯": {...},
            "æˆé•¿å¼§å…‰": [...],
            "è¯­éŸ³é£æ ¼": {...}
          }
```

#### 3.1.3 åŠ¿åŠ›è®¾è®¡ç³»ç»Ÿï¼ˆä¿®ä»™å°è¯´æ ¸å¿ƒï¼‰

å¯¹äºä¿®ä»™ç­‰é•¿ç¯‡å°è¯´ï¼ŒåŠ¿åŠ›ï¼ˆé—¨æ´¾/å®¶æ—/ç»„ç»‡ï¼‰æ˜¯æ ¸å¿ƒå…ƒç´ ã€‚æ¯ä¸ªåŠ¿åŠ›éœ€è¦ï¼š

**åŠ¿åŠ›è®¾è®¡ä»»åŠ¡çš„ä½œç”¨**ï¼š
- ç³»ç»ŸåŒ–ç®¡ç†æ‰€æœ‰åŠ¿åŠ›è®¾å®š
- æ¯ä¸ªåŠ¿åŠ›åŒ…å«ï¼šä¿¡ä»°/ç›®æ ‡ã€èƒ½åŠ›ä½“ç³»ã€äººå‘˜ç»“æ„ã€åœ°ç›˜èŒƒå›´ã€ä¸å…¶ä»–åŠ¿åŠ›çš„å…³ç³»
- ä¸ºäººç‰©è®¾è®¡æä¾›å½’å±èƒŒæ™¯
- ä¸ºäº‹ä»¶è®¾è®¡æä¾›å†²çªæ¥æº

**åŠ¿åŠ›åˆ—è¡¨è¾“å‡ºæ ¼å¼**ï¼š
```json
{
  "ä¸»çº¿åŠ¿åŠ›": [
    {
      "name": "é’ç„å®—",
      "type": "æ­£é“é—¨æ´¾",
      "core_belief": "ä»¥å¾·æœäººï¼Œå®ˆæŠ¤è‹ç”Ÿ",
      "core_goal": "ç»´æŠ¤ä¿®ä»™ç•Œå’Œå¹³ï¼ŒåŸ¹å…»æ­£é“äººæ‰",
      "power_system": "é’ç„å‰‘è¯€",
      "personnel": {
        "leader": "é’ç„å­",
        "elders": ["å¤§é•¿è€", "äºŒé•¿è€"],
        "disciples": "å†…é—¨å¼Ÿå­ã€å¤–é—¨å¼Ÿå­ã€æ‚å½¹å¼Ÿå­"
      },
      "territory": "é’ç„å±±è„‰ï¼Œå±±é—¨ä½äºä¸»å³°",
      "resources": "çµçŸ³çŸ¿è„‰ã€ä¸¹è¯ã€åŠŸæ³•é˜",
      "relationships": {
        "allies": ["å¤©å‰‘å®—"],
        "enemies": ["é­”é—¨", "è¡€ç…æ•™"],
        "neutral": ["ä¸¹é¼å®—"]
      },
      "unique_features": ["æŠ¤å±±å¤§é˜µ", "ä¼ æ‰¿ç§˜å¢ƒ"]
    }
  ],
  "æ•Œå¯¹åŠ¿åŠ›": [
    {
      "name": "é­”é—¨",
      "type": "é­”é“åŠ¿åŠ›",
      "core_belief": "å¼±è‚‰å¼ºé£Ÿï¼Œå¼ºè€…ä¸ºå°Š",
      "core_goal": "ç§°éœ¸ä¿®ä»™ç•Œï¼Œæ å¤ºèµ„æº",
      ...
    }
  ]
}
```

**ä¸æ’ä»¶ç³»ç»Ÿçš„è”åŠ¨**ï¼š
- WorldViewPlugin çš„ `_factions` å­˜å‚¨æ‰€æœ‰åŠ¿åŠ›æ•°æ®
- äººç‰©è®¾è®¡æ—¶ï¼Œç³»ç»Ÿè‡ªåŠ¨æ³¨å…¥æ‰€å±åŠ¿åŠ›ä¿¡æ¯
- äº‹ä»¶è®¾è®¡æ—¶ï¼Œç³»ç»Ÿè‡ªåŠ¨æä¾›ç›¸å…³åŠ¿åŠ›ä½œä¸ºå†²çªæ¥æº
- å†™ç« èŠ‚æ—¶ï¼Œç³»ç»Ÿè‡ªåŠ¨æé†’æ¶‰åŠåŠ¿åŠ›çš„è®¾å®šå’Œå…³ç³»

#### 3.1.4 äº‹ä»¶å’Œä¼ç¬”åˆ—è¡¨ç³»ç»Ÿ

**äº‹ä»¶ä»»åŠ¡çš„ä½œç”¨**ï¼š
- å°†å¤§çº²ä¸­çš„"ä¸€å¥è¯æ¢—æ¦‚"æ‰©å±•ä¸ºè¯¦ç»†çš„äº‹ä»¶æè¿°
- ä¸ºæ¯ä¸ªäº‹ä»¶å®šä¹‰ï¼šç« èŠ‚ã€äººç‰©ã€èµ·å› ã€ç»è¿‡ã€ç»“æœã€æ¨åŠ¨çš„æƒ…èŠ‚
- ç¡®ä¿äº‹ä»¶ä¹‹é—´æœ‰å› æœå…³ç³»ï¼Œä¸æ˜¯"ç„¶å...ç„¶å..."

**äº‹ä»¶åˆ—è¡¨è¾“å‡ºæ ¼å¼**ï¼š
```json
{
  "ä¸»çº¿äº‹ä»¶": [
    {
      "name": "é­”é—¨è°ˆåˆ¤",
      "chapter": 30,
      "characters": ["æ—å°æ»¡", "é­”é—¨é•¿è€"],
      "cause": "é’ç„å®—éœ€è¦èµ„æºæ”¯æŒ",
      "process": "è°ˆåˆ¤è¿‡ç¨‹ã€åˆ†æ­§ã€å†²çª",
      "outcome": "è¾¾æˆä¸´æ—¶åè®®ï¼ŒåŸ‹ä¸‹éšæ‚£",
      "foreshadowing": "ç¬¬50ç« å†²çª"
    }
  ]
}
```

**ä¼ç¬”åˆ—è¡¨ä»»åŠ¡çš„ä½œç”¨**ï¼š
- ç³»ç»ŸåŒ–ç®¡ç†æ‰€æœ‰ä¼ç¬”ï¼ˆä¸»çº¿ã€æ”¯çº¿ã€äººç‰©ã€ä¸–ç•Œè§‚ï¼‰
- è®°å½•æ¯ä¸ªä¼ç¬”çš„åŸ‹è®¾ç« èŠ‚ã€å›æ”¶ç« èŠ‚ã€é‡è¦æ€§
- åœ¨ç« èŠ‚ç”Ÿæˆæ—¶è‡ªåŠ¨æé†’éœ€è¦å¤„ç†çš„ä¼ç¬”

**ä¼ç¬”åˆ—è¡¨è¾“å‡ºæ ¼å¼**ï¼š
```json
{
  "ä¸»çº¿ä¼ç¬”": [
    {"name": "èº«ä¸–ä¹‹è°œ", "plant_chapter": 1, "payoff_chapter": 50, "importance": "å…³é”®"}
  ],
  "æ”¯çº¿ä¼ç¬”": [
    {"name": "ç¥ç§˜é¡¹é“¾", "plant_chapter": 12, "payoff_chapter": 35, "importance": "é‡è¦"}
  ],
  "äººç‰©ä¼ç¬”": [
    {"character": "å¼ ä¸‰", "secret": "çœŸå®èº«ä»½", "plant": 5, "payoff": 40}
  ]
}
```

**ä¸æ’ä»¶ç³»ç»Ÿçš„è”åŠ¨**ï¼š
- å†™ç¬¬30ç« æ—¶ï¼Œç³»ç»Ÿè‡ªåŠ¨æ³¨å…¥ï¼š
  ```
  ğŸ“Œ æœ¬ç« éœ€è¦å¤„ç†çš„äº‹ä»¶ï¼š
  â€¢ é­”é—¨è°ˆåˆ¤ï¼ˆç¬¬30ç« ä¸»çº¿äº‹ä»¶ï¼‰
  â€¢ èµ·å› ï¼šé’ç„å®—éœ€è¦èµ„æº
  â€¢ ç»“æœï¼šè¾¾æˆåè®®ä½†åŸ‹éšæ‚£

  ğŸ“Œ æœ¬ç« éœ€è¦å¤„ç†çš„ä¼ç¬”ï¼š
  â€¢ å›æ”¶ï¼šç¬¬3ç« çš„"ç”µç“¶è½¦æ®‹å½±"ï¼ˆæ­ç¤ºæ˜¯é’ç„ç¥–å¸ˆï¼‰
  â€¢ åŸ‹è®¾ï¼šè°ˆåˆ¤éšæ‚£ï¼ˆä¸ºç¬¬50ç« é“ºå«ï¼‰
  ```

#### 3.1.5 ä¾èµ–å…³ç³»è‡ªåŠ¨å¼•ç”¨

```python
TASK_DEPENDENCIES = {
    # Phase 0: åˆ›æ„è„‘æš´é˜¶æ®µ
    "åˆ›æ„è„‘æš´": [],

    # Phase 1: å¤§çº²è®¾è®¡
    "å¤§çº²": ["åˆ›æ„è„‘æš´"],

    # Phase 2: åŸºç¡€å…ƒç´ è®¾è®¡
    "ä¸–ç•Œè§‚è§„åˆ™": ["å¤§çº²"],
    "åŠ¿åŠ›è®¾è®¡": ["å¤§çº²", "ä¸–ç•Œè§‚è§„åˆ™"],

    # Phase 3: è¯¦ç»†å…ƒç´ è®¾è®¡
    "åœºæ™¯è®¾è®¡": ["å¤§çº²", "ä¸–ç•Œè§‚è§„åˆ™", "åŠ¿åŠ›è®¾è®¡"],
    "äººç‰©è®¾è®¡": ["å¤§çº²", "ä¸–ç•Œè§‚è§„åˆ™", "åŠ¿åŠ›è®¾è®¡"],
    "åŠŸæ³•æ³•å®": ["å¤§çº²", "ä¸–ç•Œè§‚è§„åˆ™", "åŠ¿åŠ›è®¾è®¡"],
    "ä¸»è§’æˆé•¿": ["å¤§çº²", "ä¸–ç•Œè§‚è§„åˆ™", "åŠŸæ³•æ³•å®", "äººç‰©è®¾è®¡"],
    "åæ´¾è®¾è®¡": ["å¤§çº²", "äººç‰©è®¾è®¡", "ä¸»è§’æˆé•¿", "åŠ¿åŠ›è®¾è®¡"],

    # Phase 4: å¯¹æ‰‹ä¸äº‹ä»¶è§„åˆ’
    "äº‹ä»¶": ["å¤§çº²", "ä¸–ç•Œè§‚è§„åˆ™", "åŠ¿åŠ›è®¾è®¡", "åœºæ™¯è®¾è®¡", "äººç‰©è®¾è®¡", "åæ´¾è®¾è®¡"],
    "æ—¶é—´çº¿": ["å¤§çº²", "äººç‰©è®¾è®¡", "äº‹ä»¶", "ä¸»è§’æˆé•¿"],

    # Phase 5: ä¼ç¬”ç®¡ç†
    "ä¼ç¬”åˆ—è¡¨": ["å¤§çº²", "åŠ¿åŠ›è®¾è®¡", "äººç‰©è®¾è®¡", "äº‹ä»¶", "æ—¶é—´çº¿"],

    # Phase 6: ç« èŠ‚åˆ›ä½œ
    "ç« èŠ‚å†…å®¹": ["å¤§çº²", "ä¸–ç•Œè§‚è§„åˆ™", "åŠ¿åŠ›è®¾è®¡", "åœºæ™¯è®¾è®¡", "äººç‰©è®¾è®¡",
                 "åŠŸæ³•æ³•å®", "ä¸»è§’æˆé•¿", "åæ´¾è®¾è®¡", "äº‹ä»¶", "æ—¶é—´çº¿", "ä¼ç¬”åˆ—è¡¨"],

    # Phase 7: è´¨é‡æ£€æŸ¥ï¼ˆæ¯ç« åè‡ªåŠ¨è¿è¡Œï¼‰
    "ä¸€è‡´æ€§æ£€æŸ¥": ["ç« èŠ‚å†…å®¹"],
    "å¯¹è¯æ£€æŸ¥": ["ç« èŠ‚å†…å®¹"],
}

# ç”Ÿæˆ"äººç‰©è®¾è®¡"æ—¶ï¼Œç³»ç»Ÿè‡ªåŠ¨ï¼š
# 1. è·å–"å¤§çº²"çš„å®Œæ•´å†…å®¹
# 2. æ”¾å…¥ predecessor_contents["å¤§çº²"]
# 3. æç¤ºè¯ä¸­è‡ªåŠ¨åŒ…å«ï¼š"\n### å‰ç½®å†…å®¹ï¼šå¤§çº²\n{å¤§çº²å†…å®¹}"
```

### 3.2 ä¸Šä¸‹æ–‡è¡”æ¥æœºåˆ¶

#### 3.2.1 ä¸‰å±‚ä¸Šä¸‹æ–‡è·å–

**å±‚1ï¼šä»»åŠ¡ä¾èµ–å†…å®¹**
```python
# å†™ç¬¬30ç« æ—¶ï¼Œè‡ªåŠ¨è·å–ï¼š
predecessor_contents = {
    "å¤§çº²": "...",
    "ä¸–ç•Œè§‚è§„åˆ™": "...",
    "åŠ¿åŠ›è®¾è®¡": "...",
    "åœºæ™¯è®¾è®¡": "...",
    "äººç‰©è®¾è®¡": "...",
    "åŠŸæ³•æ³•å®": "...",
    "ä¸»è§’æˆé•¿": "...",
    "åæ´¾è®¾è®¡": "...",
    "äº‹ä»¶": "...",
    "æ—¶é—´çº¿": "...",
    "ä¼ç¬”åˆ—è¡¨": "...",
    "ç¬¬29ç« ": "...",  # ä¸Šä¸€ç« 
    "ç¬¬28ç« ": "...",  # å‰ä¸¤ç« 
}
```

**å±‚2ï¼šæ’ä»¶ä¸Šä¸‹æ–‡å¢å¼º**
```python
enriched_context = {
    "character": {
        "current_scene_characters": ["ææ˜", "ç‹é•¿è€"],
        "relationships": [{"ææ˜ â†” ç‹é•¿è€": "å¸ˆå¾’"}],
        "character_voices": {"ææ˜": "æ²‰ç¨³", "ç‹é•¿è€": "å¨ä¸¥"},
    },
    "worldview": {
        "current_location": "é’ç„å®—-å¤§æ®¿",
        "relevant_rules": ["ç‚¼æ°”æœŸä¸å¾—é£è¡Œ", "é•¿è€å­å¼Ÿä¸å¯æ¬ºè¾±"],
    },
    "factions": {
        "é’ç„å®—": {"å†…æ ¸": "ä»¥å¾·æœäºº", "ä¸ä¸»è§’å…³ç³»": "å¸ˆé—¨"},
        "é­”é—¨": {"å†…æ ¸": "å¼±è‚‰å¼ºé£Ÿ", "ä¸ä¸»è§’å…³ç³»": "æ•Œå¯¹"},
    },
    "foreshadow": {
        "to_plant": [
            "- ç¥ç§˜é¡¹é“¾: ä¸»è§’åœ¨å¤§æ®¿å‘ç°ä¸€æšå¤è€é¡¹é“¾ (éšè”½ç¨‹åº¦: subtle)"
        ],
        "to_payoff": [
            "- é¢„è¨€ä¸­çš„å‹‡è€…: é•¿è€è®¤å‡ºä¸»è§’æ˜¯é¢„è¨€ä¸­äºº (åŸ‹è®¾äºç¬¬3ç« )"
        ]
    }
}
```

**å±‚3ï¼šå‘é‡è¯­ä¹‰æ£€ç´¢**
```python
# å†™ç¬¬50ç« æ—¶ï¼Œéœ€è¦å›é¡¾ç¬¬5ç« çš„æŸä¸ªç»†èŠ‚
search_results = VectorMemory.search(
    query="ä¸»è§’ç¬¬ä¸€æ¬¡è§åˆ°é­”é—¨é•¿è€",
    memory_type=CHAPTER,
    top_k=3
)
# è¿”å›ï¼šç¬¬5ç« ã€ç¬¬8ç« ã€ç¬¬12ç« çš„ç›¸å…³ç‰‡æ®µ
```

#### 3.2.2 æç¤ºè¯ç»„è£…

```python
æç¤ºè¯ç»“æ„ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ## ä»»åŠ¡è¯´æ˜                          â”‚
â”‚ å½“å‰ä»»åŠ¡ï¼šç¬¬30ç«  - ç« èŠ‚å†…å®¹          â”‚
â”‚ ç›®æ ‡ï¼šä¸»è§’åˆ°é­”é—¨è°ˆåˆ¤                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ## å‰ç½®å†…å®¹ï¼ˆè‡ªåŠ¨è·å–ï¼‰              â”‚
â”‚ ### å¤§çº²                            â”‚
â”‚ ...ï¼ˆè‡ªåŠ¨æ’å…¥å¤§çº²å†…å®¹ï¼‰              â”‚
â”‚                                     â”‚
â”‚ ### ä¸–ç•Œè§‚è§„åˆ™                      â”‚
â”‚ ...ï¼ˆè‡ªåŠ¨æ’å…¥ä¸–ç•Œè§‚ï¼‰                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ## ä¸Šä¸‹æ–‡æç¤º                        â”‚
â”‚ ### å½“å‰åœºæ™¯                        â”‚
â”‚ - åœ°ç‚¹ï¼šé’ç„å®—-å¤§æ®¿                 â”‚
â”‚ - äººç‰©ï¼šææ˜ï¼ˆä¸»è§’ï¼‰ã€ç‹é•¿è€         â”‚
â”‚ - å…³ç³»ï¼šå¸ˆå¾’                        â”‚
â”‚                                     â”‚
â”‚ ### ç›¸å…³åŠ¿åŠ›                        â”‚
â”‚ - é’ç„å®—ï¼šä»¥å¾·æœäººï¼ˆç›Ÿå‹ï¼‰           â”‚
â”‚                                     â”‚
â”‚ ### ä¼ç¬”æç¤º                        â”‚
â”‚ - éœ€è¦åŸ‹è®¾ï¼šç¥ç§˜é¡¹é“¾                â”‚
â”‚ - éœ€è¦å›æ”¶ï¼šç¬¬3ç« çš„é¢„è¨€             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ## å‰å‡ èŠ‚å†…å®¹å‚è€ƒ                   â”‚
â”‚ ### ç¬¬28ç« ï¼šææ˜è¢«é•¿è€æ´¾å»è°ˆåˆ¤      â”‚
â”‚ ### ç¬¬29ç« ï¼šææ˜åˆ°è¾¾é­”é—¨å±±è„š        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.3 è´¨é‡ä¿è¯ç³»ç»Ÿ

#### 3.3.1 å¤šç»´åº¦è¯„ä¼°

```python
è¯„ä¼°ç»´åº¦ï¼ˆæ€»åˆ†100ï¼‰ï¼š
â”œâ”€ è¿è´¯æ€§ (20åˆ†)ï¼šä¸ä¸Šæ–‡è¡”æ¥æ˜¯å¦è‡ªç„¶
â”œâ”€ åˆ›æ„æ€§ (20åˆ†)ï¼šæ˜¯å¦æœ‰æ–°æ„ã€èŠ‚å¥æ˜¯å¦å¥½
â”œâ”€ è´¨é‡ (20åˆ†)ï¼šæ–‡ç¬”ã€æå†™ã€å¯¹è¯
â”œâ”€ ä¸€è‡´æ€§ (20åˆ†)ï¼šäººç‰©ã€ä¸–ç•Œè§‚æ˜¯å¦ä¸€è‡´
â””â”€ ç›®æ ‡å¯¹é½ (20åˆ†)ï¼šæ˜¯å¦ç¬¦åˆç« èŠ‚ç›®æ ‡

è´¨é‡é˜ˆå€¼ï¼š70åˆ†
```

**è¯„ä¼°æç¤ºè¯ç¤ºä¾‹**ï¼š
```python
# è¯„ä¼°ç¬¬30ç« è´¨é‡æ—¶ï¼Œç³»ç»Ÿä¼šæ£€æŸ¥ï¼š
1. è¿è´¯æ€§ï¼š
   - ä¸ç¬¬29ç« ï¼ˆåˆ°è¾¾é­”é—¨ï¼‰æ˜¯å¦è‡ªç„¶è¡”æ¥ï¼Ÿ
   - åœºæ™¯è½¬æ¢æ˜¯å¦åˆç†ï¼Ÿ

2. ä¸€è‡´æ€§ï¼š
   - ææ˜çš„æ€§æ ¼æ˜¯å¦ä¸å‰é¢ä¸€è‡´ï¼ˆåšéŸ§ã€é‡æƒ…ï¼‰ï¼Ÿ
   - æ˜¯å¦éµå®ˆäº†ä¸–ç•Œè§‚è§„åˆ™ï¼ˆç‚¼æ°”æœŸé™åˆ¶ï¼‰ï¼Ÿ
   - é­”é—¨çš„"å¼±è‚‰å¼ºé£Ÿ"å†…æ ¸æ˜¯å¦ä½“ç°ï¼Ÿ

3. ä¼ç¬”ï¼š
   - æ˜¯å¦æ­£ç¡®åŸ‹è®¾äº†"ç¥ç§˜é¡¹é“¾"ï¼Ÿ
   - æ˜¯å¦æ­£ç¡®å›æ”¶äº†ç¬¬3ç« çš„"é¢„è¨€"ï¼Ÿ

4. ç›®æ ‡å¯¹é½ï¼š
   - æ˜¯å¦å®ç°äº†"åˆ°é­”é—¨è°ˆåˆ¤"çš„ç›®æ ‡ï¼Ÿ
```

#### 3.3.2 è‡ªåŠ¨é‡å†™æœºåˆ¶

```python
è´¨é‡æ£€æŸ¥æµç¨‹ï¼š
for attempt in range(3):
    content = llm.generate(context)
    score = evaluate(content)

    if score >= 70:
        ä¿å­˜å†…å®¹
        æ ‡è®°ä¸º"å®Œæˆ"
        break

    if attempt < 2:
        # é‡å†™ï¼Œå¸¦ä¸Šè¯„ä¼°åé¦ˆ
        context["rewrite_feedback"] = f"ä¸Šæ¬¡å¾—åˆ†{score}ï¼Œé—®é¢˜ï¼š{issues}"
        # é‡æ–°ç”Ÿæˆ
    else:
        # ç¬¬3æ¬¡ä»ä¸é€šè¿‡
        ä¿å­˜æœ€åä¸€æ¬¡å†…å®¹
        æ ‡è®°ä¸º"è´¨é‡æœªé€šè¿‡"
        æ ‡è®°ä¸º"éœ€è¦äººå·¥å®¡æ ¸"
        è®°å½•è¯„ä¼°é—®é¢˜
```

#### 3.3.3 ä¸€è‡´æ€§éªŒè¯

**å››é‡éªŒè¯**ï¼š

1. **æ’ä»¶å†…éƒ¨éªŒè¯**
```python
CharacterPlugin.validate(data):
    - æ£€æŸ¥å¿…å¡«å­—æ®µï¼ˆå§“åã€è§’è‰²ã€æ€§æ ¼ï¼‰
    - æ£€æŸ¥æ€§æ ¼æ˜¯å¦è¿‡äºç®€å•ï¼ˆå°‘äº3ä¸ªç‰¹è´¨ï¼‰
    - æ£€æŸ¥ä¸»è§’æ˜¯å¦æœ‰æˆé•¿å¼§å…‰
```

2. **è·¨æ’ä»¶ä¸€è‡´æ€§**
```python
# ç« èŠ‚ç”Ÿæˆå
PluginManager.validate_cross_plugin_consistency():
    - è§’è‰²-å¯¹è¯ï¼šä¸»è¦è§’è‰²éƒ½æœ‰è¯­éŸ³æ¡£æ¡ˆï¼Ÿ
    - äº‹ä»¶-ä¼ç¬”ï¼šé‡å¤§äº‹ä»¶éƒ½æœ‰ä¼ç¬”é“ºå«ï¼Ÿ
    - é—¨æ´¾-ä¸–ç•Œè§‚ï¼šé—¨æ´¾è®¾å®šæ˜¯å¦ä¸ä¸–ç•Œè§‚ä¸€è‡´ï¼Ÿ
```

3. **æ’ä»¶çŠ¶æ€åŒæ­¥**
```python
# äººç‰©è®¾è®¡å®Œæˆå
PluginManager.sync_plugin_states():
    - è‡ªåŠ¨ä¸ºè§’è‰²åˆ›å»ºè¯­éŸ³æ¡£æ¡ˆ
    - è‡ªåŠ¨æ›´æ–°äººç‰©å…³ç³»å›¾
```

4. **ä¼ç¬”è¿½è¸ª**
```python
# æ¯ç« ç”Ÿæˆå
ForeshadowPlugin:
    - è®°å½•å·²åŸ‹è®¾çš„ä¼ç¬”
    - è®°å½•å·²å›æ”¶çš„ä¼ç¬”
    - æ ‡è®°æœªå›æ”¶çš„ä¼ç¬”
    - ä¸‹ä¸€ç« è‡ªåŠ¨æç¤ºéœ€è¦å¤„ç†çš„ä¼ç¬”
```

### 3.4 æ–­ç‚¹ç»­å†™æœºåˆ¶

#### 3.4.1 çŠ¶æ€ä¿å­˜

**éœ€è¦ä¿å­˜çš„å®Œæ•´çŠ¶æ€**ï¼š
```python
Session = {
    "åŸºç¡€ä¿¡æ¯": {
        "session_id": "uuid",
        "é¡¹ç›®åç§°": "éƒ½å¸‚ä¿®ä»™äºŒåˆ›",
        "æ€»ç« èŠ‚æ•°": 100,
        "å½“å‰ç« èŠ‚": 30,
        "çŠ¶æ€": "running" | "paused" | "completed",
    },

    "ä»»åŠ¡çŠ¶æ€": {
        "å·²å®Œæˆä»»åŠ¡": ["é£æ ¼å…ƒç´ ", "ä¸»é¢˜ç¡®è®¤", "å¤§çº²", ...],
        "å½“å‰ä»»åŠ¡": {"task_id": "chapter_30", "status": "running"},
        "å¾…æ‰§è¡Œä»»åŠ¡": ["ç¬¬31ç« ", "ç¬¬32ç« ", ...],
    },

    "æ’ä»¶çŠ¶æ€": {
        "character": {
            "ä¸»è§’": {...},
            "é…è§’": [...],
            "å…³ç³»å›¾": {...},
        },
        "worldview": {
            "ä¸–ç•Œè§‚": {...},
            "é—¨æ´¾": [...],
        },
        "foreshadow": {
            "å·²åŸ‹è®¾": [...],
            "å·²å›æ”¶": [...],
            "æœªå›æ”¶": [...],
        },
    },

    "å†…å®¹å­˜å‚¨": {
        "ç« èŠ‚å†…å®¹": {
            "ç¬¬1ç« ": {"content": "...", "score": 85, "status": "completed"},
            "ç¬¬2ç« ": {"content": "...", "score": 78, "status": "completed"},
            ...
            "ç¬¬30ç« ": {"content": "...", "score": 65, "status": "failed"},  # è´¨é‡æœªé€šè¿‡
        },
    },

    "å‘é‡è®°å¿†": {
        "æ‰€æœ‰ä»»åŠ¡ç»“æœçš„å‘é‡åµŒå…¥",
        "æ”¯æŒè¯­ä¹‰æ£€ç´¢",
    },
}
```

#### 3.4.2 æ–­ç‚¹æ¢å¤

```python
# ç”¨æˆ·ç‚¹å‡»"ç»§ç»­å†™ä½œ"
session = load_from_database(session_id)

# æ¢å¤çŠ¶æ€
1. æ¢å¤ä»»åŠ¡é˜Ÿåˆ— â†’ ä»å½“å‰ä»»åŠ¡ç»§ç»­
2. æ¢å¤æ’ä»¶çŠ¶æ€ â†’ åŠ è½½æ‰€æœ‰äººç‰©ã€é—¨æ´¾ã€ä¼ç¬”æ•°æ®
3. æ¢å¤å‘é‡è®°å¿† â†’ å¯ä»¥æ£€ç´¢ä¹‹å‰çš„å†…å®¹
4. æ¢å¤ä¸Šä¸‹æ–‡ â†’ çŸ¥é“å†™åˆ°ç¬¬å‡ ç« ï¼Œå‰é¢å†™äº†ä»€ä¹ˆ

# ç»§ç»­æ‰§è¡Œ
engine = LoopEngine(session_id, plugin_manager, restored_state=True)
engine.resume()  # ä»æ–­ç‚¹ç»§ç»­
```

#### 3.4.3 æš‚åœæœºåˆ¶

```python
# ç”¨æˆ·ç‚¹å‡»"æš‚åœ"
engine.pause()

# ä¿å­˜çŠ¶æ€
1. ä¿å­˜å½“å‰ä»»åŠ¡æ‰§è¡Œåˆ°å“ªä¸€æ­¥
2. ä¿å­˜æ‰€æœ‰æ’ä»¶çŠ¶æ€
3. ä¿å­˜å‘é‡è®°å¿†
4. æ›´æ–°sessionçŠ¶æ€ä¸º"paused"

# ä¸‹æ¬¡å¯ä»¥æ— ç¼ç»§ç»­
```

### 3.5 å•ç« é‡å†™åŠŸèƒ½

#### 3.5.1 é—®é¢˜åœºæ™¯

```
ç¬¬30ç« ç”Ÿæˆå®Œæˆï¼Œä½†ï¼š
- è´¨é‡è¯„åˆ†65åˆ†ï¼ˆæœªé€šè¿‡70åˆ†é˜ˆå€¼ï¼‰
- 3æ¬¡é‡å†™åä»ç„¶ä¸é€šè¿‡
- ä¿ç•™äº†æœ€åä¸€æ¬¡çš„å†…å®¹
- æ ‡è®°ä¸º"è´¨é‡æœªé€šè¿‡"ã€"éœ€è¦äººå·¥å®¡æ ¸"
```

#### 3.5.2 é‡å†™æµç¨‹

```python
# ç”¨æˆ·ç‚¹å‡»"é‡å†™ç¬¬30ç« "
1. åŠ è½½ç¬¬30ç« çš„ä¸Šä¸‹æ–‡
   - å‰é¢ç« èŠ‚çš„å†…å®¹ï¼ˆç¬¬28ã€29ç« ï¼‰
   - ç›¸å…³çš„äººç‰©ã€é—¨æ´¾ã€ä¼ç¬”ä¿¡æ¯
   - å¤§çº²ä¸­çš„ç« èŠ‚ç›®æ ‡
   - ä¹‹å‰ç”Ÿæˆçš„ç‰ˆæœ¬ï¼ˆç”¨äºå¯¹æ¯”ï¼‰

2. æ¸…ç©ºç¬¬30ç« çš„æ—§å†…å®¹
   - ä»contentä¸­åˆ é™¤
   - ä½†ä¿ç•™åœ¨å†å²è®°å½•ä¸­

3. é‡æ–°ç”Ÿæˆ
   - è‡ªåŠ¨æ³¨å…¥å®Œæ•´çš„ä¸Šä¸‹æ–‡
   - é‡æ–°è°ƒç”¨LLMç”Ÿæˆ
   - é‡æ–°è¿›è¡Œè´¨é‡è¯„ä¼°

4. å¦‚æœé€šè¿‡
   - ä¿å­˜æ–°å†…å®¹
   - æ›´æ–°çŠ¶æ€ä¸º"completed"

5. å¦‚æœä»ä¸é€šè¿‡
   - ä¿ç•™æ–°ç‰ˆæœ¬
   - ä»æ ‡è®°ä¸º"éœ€è¦å®¡æ ¸"
   - å¯ä»¥ç»§ç»­é‡å†™
```

#### 3.5.3 å†å²ç‰ˆæœ¬ç®¡ç†

```python
# æ¯ç« ç»´æŠ¤ç‰ˆæœ¬å†å²
ç¬¬30ç«  = {
    "current_version": "v3",
    "status": "failed",
    "versions": {
        "v1": {
            "content": "...",
            "score": 60,
            "created_at": "2026-01-29 10:00",
            "issues": ["è¡”æ¥ä¸è‡ªç„¶", "ä¼ç¬”é—æ¼"],
        },
        "v2": {
            "content": "...",
            "score": 65,
            "created_at": "2026-01-29 10:05",
            "issues": ["äººç‰©æ€§æ ¼ä¸ä¸€è‡´"],
        },
        "v3": {
            "content": "...",  # å½“å‰ç‰ˆæœ¬
            "score": 65,
            "created_at": "2026-01-29 10:10",
            "issues": ["æ–‡ç¬”å¾…æå‡"],
        },
    }
}

---

### 3.6 æ¨¡å—åŒ–ä¸‰å¹•ç»“æ„ä¸æ•…äº‹å•å…ƒè§„åˆ’

#### 3.6.1 ä¸ºä»€ä¹ˆéœ€è¦æ¨¡å—åŒ–ç»“æ„ï¼Ÿ

**ä¼ ç»Ÿä¸‰å¹•ç»“æ„çš„é—®é¢˜**ï¼ˆä¸é€‚åˆé•¿ç¯‡ç½‘ç»œå°è¯´ï¼‰ï¼š
- å°†1000ç« å¥—è¿›ä¸€ä¸ªä¸‰å¹•ç»“æ„
- ç¬¬äºŒå¹•å 60% = 600ç« ï¼Œè¿‡äºæ¼«é•¿ï¼Œè¯»è€…å®¹æ˜“æµå¤±
- å•ä¸€çº¿æ€§å™äº‹æ— æ³•æ”¯æ’‘å¤æ‚çš„å‡çº§æµ
- ä¸­åæœŸå®¹æ˜“å¿˜è®°å‰æœŸä¼ç¬”ï¼Œå‰åçŸ›ç›¾

**è§£å†³æ–¹æ¡ˆï¼šæ— é™é‡å¤çš„æ¨¡å—åŒ–ä¸‰å¹•ç»“æ„**
```
1000ç« å°è¯´ = 10ä¸ªæ•…äº‹å•å…ƒ Ã— æ¯å•å…ƒ100ç«  Ã— æ¯å•å…ƒå®Œæ•´ä¸‰å¹•
```

#### 3.6.2 æ¨¡å—åŒ–ç»“æ„æ ¸å¿ƒè®¾è®¡

**ç»“æ„æ¦‚è§ˆï¼ˆä»¥1000ç« ä¿®ä»™å°è¯´ä¸ºä¾‹ï¼‰**ï¼š
```
Novel Structure (1000 chapters):
â”œâ”€â”€ Module 1: "æ–°æ‰‹æ‘ç¯‡" (Chapters 1-100) - ç‚¼æ°”æœŸ
â”‚   â”œâ”€â”€ Act 1 (20%): è¿›å…¥æ‘åº„ï¼Œè§¦å‘é‡‘æ‰‹æŒ‡ï¼Œå»ºç«‹è§„åˆ™
â”‚   â”œâ”€â”€ Act 2 (60%): ä¿®ç‚¼å‡çº§ï¼Œæ‰“è„¸åæ´¾ï¼Œç§¯ç´¯çŸ›ç›¾
â”‚   â””â”€â”€ Act 3 (20%): å†³æˆ˜æ‘éœ¸ï¼Œç¦»å¼€æ‘åº„ï¼Œå‰å¾€å®—é—¨
â”‚
â”œâ”€â”€ Module 2: "å®—é—¨å¤–å›´ç¯‡" (Chapters 101-200) - ç­‘åŸºæœŸ
â”‚   â”œâ”€â”€ Act 1 (20%): å…¥é—¨æµ‹è¯•ï¼Œæˆä¸ºå¤–é—¨å¼Ÿå­
â”‚   â”œâ”€â”€ Act 2 (60%): å¤–é—¨ç«äº‰ï¼Œä»»åŠ¡å†ç»ƒï¼Œæ™‹å‡å†…é—¨
â”‚   â””â”€â”€ Act 3 (20%): å®—é—¨å¤§æ¯”ï¼Œè·å¾—çœŸä¼ ï¼Œè¿›å…¥æ ¸å¿ƒ
â”‚
â”œâ”€â”€ Module 3: "å®—é—¨æ ¸å¿ƒç¯‡" (Chapters 201-300) - é‡‘ä¸¹æœŸ
â”‚   â”œâ”€â”€ Act 1: çœŸä¼ å¼Ÿå­ç”Ÿæ´»ï¼Œæ›´é«˜è§„åˆ™
â”‚   â”œâ”€â”€ Act 2: æ ¸å¿ƒç«äº‰ï¼Œç§˜å¢ƒæ¢ç´¢ï¼Œäº‰å¤ºèµ„æº
â”‚   â””â”€â”€ Act 3: æ ¸å¿ƒå¼Ÿå­ç¬¬ä¸€ï¼Œè·å¾—ä¼ æ‰¿ï¼Œæ™‹å‡é•¿è€
â”‚
â”œâ”€â”€ Module 4: "å·åŸç¯‡" (Chapters 301-450) - å…ƒå©´æœŸ
â”‚   â”œâ”€â”€ Act 1: è¿›å…¥å·åŸï¼Œæ›´å¤§ä¸–ç•Œè§„åˆ™
â”‚   â”œâ”€â”€ Act 2: å·åŸåŠ¿åŠ›äº‰æ–—ï¼Œå»ºç«‹åŠ¿åŠ›
â”‚   â””â”€â”€ Act 3: å·åŸå¤§æ¯”ç¬¬ä¸€ï¼Œåéœ‡ä¸€æ–¹
â”‚
â”œâ”€â”€ Module 5: "ä¸­å·ç¯‡" (Chapters 451-600) - åŒ–ç¥æœŸ
â”‚   â”œâ”€â”€ Act 1: è¿›å…¥ä¸­å·ï¼Œæ ¸å¿ƒåœ°åŸŸ
â”‚   â”œâ”€â”€ Act 2: ä¸­å·é£äº‘ï¼Œè·¨å·äº‰æ–—
â”‚   â””â”€â”€ Act 3: ä¸­å·éœ¸ä¸»ï¼Œå‡†å¤‡é£å‡
â”‚
â”œâ”€â”€ Module 6: "ä¸Šç•Œç¯‡" (Chapters 601-750) - æ¸¡åŠ«æœŸ
â”‚   â”œâ”€â”€ Act 1: é£å‡ä¸Šç•Œï¼Œæ–°ä¸–ç•Œè§„åˆ™
â”‚   â”œâ”€â”€ Act 2: ä¸Šç•Œç«‹è¶³ï¼Œå¾æˆ˜å…«æ–¹
â”‚   â””â”€â”€ Act 3: ä¸Šç•Œè‡³å°Šï¼Œå‡†å¤‡ä»™ç•Œ
â”‚
â”œâ”€â”€ Module 7-9: "ä»™ç•Œè¯¸ç¯‡" (Chapters 751-950) - å¤§ä¹˜æœŸ
â”‚   â””â”€â”€ ä»™ç•Œä¸åŒåŒºåŸŸçš„æ¢ç´¢å’Œäº‰éœ¸
â”‚
â””â”€â”€ Final Module: "ç»ˆæç¯‡" (Chapters 951-1000)
    â”œâ”€â”€ Act 1: æœ€ç»ˆå‡†å¤‡ï¼Œé›†ç»“åŠ›é‡
    â”œâ”€â”€ Act 2: å¤©é“è¯•ç‚¼ï¼Œç»ˆæçªç ´
    â””â”€â”€ Act 3: ç»ˆæBOSSæˆ˜ï¼Œæ‹¯æ•‘/æ”¹å˜ä¸–ç•Œ
```

**æ¨¡å—åŒ–ç»“æ„çš„ä¼˜åŠ¿**ï¼š
1. **æŒç»­å°é«˜æ½®**ï¼šæ¯100ç« å°±æœ‰ä¸€ä¸ªå®Œæ•´æ•…äº‹é«˜æ½®ï¼Œä¿æŒè¯»è€…å…´è¶£
2. **æ¢åœ°å›¾æœºåˆ¶**ï¼šæ–°æ‰‹æ‘â†’å®—é—¨â†’å·åŸâ†’ä¸­å·â†’ä¸Šç•Œâ†’ä»™ç•Œï¼ŒæŒç»­æ–°é²œæ„Ÿ
3. **å‡çº§è‡ªç„¶è¡”æ¥**ï¼šæ¯ä¸ªæ¨¡å—å¯¹åº”ä¸€ä¸ªå¤§å¢ƒç•Œï¼ˆç‚¼æ°”â†’ç­‘åŸºâ†’é‡‘ä¸¹...ï¼‰
4. **ç‹¬ç«‹å®Œæ•´æ€§**ï¼šæ¯ä¸ªå•å…ƒå¯ä»¥ç‹¬ç«‹é˜…è¯»ï¼Œæœ‰è‡ªå·±çš„èµ·æ‰¿è½¬åˆ
5. **æ¸è¿›ä¸–ç•Œè§‚**ï¼šé€æ­¥æ­ç¤ºä¸–ç•ŒçœŸç›¸ï¼Œè€Œéä¸€æ¬¡æ€§çŒè¾“

#### 3.6.3 æ•…äº‹å•å…ƒè§„åˆ’ï¼ˆStory Unit Planningï¼‰

**ä»€ä¹ˆæ˜¯æ•…äº‹å•å…ƒè§„åˆ’ï¼Ÿ**
- åœ¨æ¯ä¸ª100ç« å•å…ƒå¼€å§‹å‰ï¼Œå…ˆè¿›è¡Œè¯¦ç»†è§„åˆ’
- ä¸æ˜¯ä¸€å¥è¯æ¦‚æ‹¬ï¼Œè€Œæ˜¯å®Œæ•´çš„"å‰§æœ¬"
- åŒ…å«å•å…ƒå†…æ‰€æœ‰ç»†èŠ‚ï¼šå‰§æƒ…ã€äººç‰©ã€äº‹ä»¶ã€ä¼ç¬”

**å•å…ƒè§„åˆ’å†…å®¹**ï¼š

```json
{
  "å•å…ƒåŸºæœ¬ä¿¡æ¯": {
    "å•å…ƒç¼–å·": 1,
    "å•å…ƒæ ‡é¢˜": "åˆå…¥ä¿®ä»™è·¯",
    "ç« èŠ‚èŒƒå›´": "ç¬¬1-100ç« ",
    "ä¸–ç•Œå±‚çº§": "å‡¡ä¿—ç•Œ/æ–°æ‰‹æ‘",
    "ä¿®ä¸ºå¢ƒç•Œ": "ç‚¼æ°”æœŸ1å±‚ â†’ ç‚¼æ°”æœŸ9å±‚"
  },
  
  "ä¸‰å¹•ç»“æ„è¯¦ç»†è§„åˆ’": {
    "ç¬¬ä¸€å¹•_å»ºç«‹": {
      "ç« èŠ‚èŒƒå›´": "ç¬¬1-20ç« ",
      "é’©å­è®¾è®¡": "ä¸»è§’ç©¿è¶Š/è§‰é†’ï¼Œè§¦å‘é‡‘æ‰‹æŒ‡",
      "ç°çŠ¶å»ºç«‹": "æ–°æ‰‹æ‘çš„è§„åˆ™ã€åŠ¿åŠ›åˆ†å¸ƒ",
      "å¼•å‘äº‹ä»¶": "ä»€ä¹ˆæ‰“ç ´ç°çŠ¶ï¼ˆå¦‚è¢«æ¬ºè´Ÿã€å‘ç°ç§˜å¯†ï¼‰"
    },
    "ç¬¬äºŒå¹•_å¯¹æŠ—": {
      "ç« èŠ‚èŒƒå›´": "ç¬¬21-80ç« ",
      "ä¸Šå‡åŠ¨ä½œ": "ä¿®ç‚¼å‡çº§ã€æ‰“è„¸å°åæ´¾ã€å»ºç«‹å…³ç³»",
      "ä¸­ç‚¹è½¬æŠ˜": "ç¬¬50ç« çš„é‡å¤§è½¬æŠ˜ï¼ˆå¦‚å‘ç°çœŸç›¸ã€è·å¾—ä¼ æ‰¿ï¼‰",
      "æŒç»­å†²çª": "ä¸ä¸­BOSSçš„å¤šæ¬¡äº¤é”‹"
    },
    "ç¬¬ä¸‰å¹•_è§£å†³": {
      "ç« èŠ‚èŒƒå›´": "ç¬¬81-100ç« ",
      "å±æœº": "å•å…ƒæœ€å¤§å±æœºï¼ˆå¤§BOSSå‡ºæ‰‹ï¼‰",
      "é«˜æ½®": "ä¸å¤§BOSSçš„å†³æˆ˜",
      "è§£å†³": "å¦‚ä½•è·èƒœï¼Œç¦»å¼€æ–°æ‰‹æ‘",
      "è¿‡æ¸¡": "å¼•å‡ºå®—é—¨ç¯‡çš„é’©å­"
    }
  },
  
  "å•å…ƒäººç‰©ä½“ç³»": {
    "æœ¬åœ°ç›Ÿå‹": [
      {"å§“å": "å¼ ä¸‰", "èº«ä»½": "æ‘ä¸­è¯æå•†", "ä½œç”¨": "æä¾›åˆæœŸèµ„æº"},
      {"å§“å": "æå››", "èº«ä»½": "é€€å½¹æ­¦å¸ˆ", "ä½œç”¨": "ä¼ æˆåŸºç¡€åŠŸæ³•"}
    ],
    "å¯¼å¸ˆ/å¼•è·¯äºº": [
      {"å§“å": "è€æ‘é•¿", "ä½œç”¨": "å¼•å¯¼ä¸»è§’è¿›å…¥ä¿®ä»™ç•Œ"}
    ],
    "å•å…ƒåæ´¾å±‚çº§": {
      "å°BOSS": {"å§“å": "ç‹äº”", "ç« èŠ‚": "ç¬¬30ç« ", "èº«ä»½": "è¡—å¤´æ¶éœ¸"},
      "ä¸­BOSS": {"å§“å": "èµµå…­", "ç« èŠ‚": "ç¬¬60ç« ", "èº«ä»½": "åœ°æ–¹è±ªå¼º"},
      "å¤§BOSS": {"å§“å": "å­™ä¸ƒ", "ç« èŠ‚": "ç¬¬90ç« ", "èº«ä»½": "å¹•åé»‘æ‰‹"}
    }
  },
  
  "å•å…ƒåŠ¿åŠ›åˆ†å¸ƒ": {
    "æœ¬åœ°åŠ¿åŠ›A": {"ç‰¹å¾": "å–„è‰¯æ‘æ°‘", "ä¸ä¸»è§’å…³ç³»": "æ”¯æŒ"},
    "æœ¬åœ°åŠ¿åŠ›B": {"ç‰¹å¾": "æ¶éœ¸é›†å›¢", "ä¸ä¸»è§’å…³ç³»": "æ•Œå¯¹"}
  },
  
  "å•å…ƒå…³é”®äº‹ä»¶": [
    {"ç« èŠ‚": 3, "äº‹ä»¶": "è§‰é†’é‡‘æ‰‹æŒ‡", "æè¿°": "ä¸»è§’è·å¾—ä¿®ä»™ç³»ç»Ÿ"},
    {"ç« èŠ‚": 8, "äº‹ä»¶": "é¦–æ¬¡æˆ˜æ–—", "æè¿°": "æ‰“è´¥è¡—å¤´æ¶éœ¸"},
    {"ç« èŠ‚": 15, "äº‹ä»¶": "è·å¾—åŠŸæ³•", "æè¿°": "è€æ‘é•¿ä¼ æˆå…¥é—¨åŠŸæ³•"},
    {"ç« èŠ‚": 30, "äº‹ä»¶": "å‡»è´¥å°BOSS", "æè¿°": "æ‰“è´¥ç‹äº”ï¼Œéœ‡æ…‘ä¸€æ–¹"},
    {"ç« èŠ‚": 50, "äº‹ä»¶": "ä¸­ç‚¹è½¬æŠ˜", "æè¿°": "å‘ç°å¤§BOSSé˜´è°‹"},
    {"ç« èŠ‚": 60, "äº‹ä»¶": "å‡»è´¥ä¸­BOSS", "æè¿°": "å‡»è´¥èµµå…­ï¼Œè·å¾—å®è—"},
    {"ç« èŠ‚": 90, "äº‹ä»¶": "å•å…ƒé«˜æ½®", "æè¿°": "ä¸å¤§BOSSå†³æˆ˜"},
    {"ç« èŠ‚": 100, "äº‹ä»¶": "ç¦»å¼€æ‘åº„", "æè¿°": "å‰å¾€å®—é—¨ï¼Œå¼€å¯æ–°ç¯‡"}
  ],
  
  "å•å…ƒä¼ç¬”ç³»ç»Ÿ": {
    "æœ¬å•å…ƒåŸ‹è®¾": [
      {"åç§°": "ç¥ç§˜ç‰ä½©", "åŸ‹è®¾ç« èŠ‚": 5, "å›æ”¶ç« èŠ‚": 90, "æè¿°": "ç‰ä½©ä¸­è—æœ‰ä¸Šå¤ä¼ æ‰¿"}
    ],
    "æœ¬å•å…ƒå›æ”¶": [
      {"åç§°": "æ‘ä¸­è¯æ", "åŸ‹è®¾": 3, "å›æ”¶": 20, "æè¿°": "åˆæœŸä¼ç¬”å›æ”¶"}
    ],
    "è·¨å•å…ƒä¼ç¬”": [
      {"åç§°": "ç¥ç§˜å¸ˆçˆ¶", "åŸ‹è®¾": 100, "å›æ”¶å•å…ƒ": 3, "æè¿°": "è€æ‘é•¿çœŸå®èº«ä»½"}
    ]
  },
  
  "å•å…ƒæˆé•¿è½¨è¿¹": {
    "è¿›å…¥æ—¶çŠ¶æ€": {
      "å®åŠ›": "å‡¡äººï¼Œæ— ä¿®ä¸º",
      "è£…å¤‡": "æ— ",
      "äººé™…å…³ç³»": "å­¤ç«‹æ— æ´"
    },
    "ç¦»å¼€æ—¶çŠ¶æ€": {
      "å®åŠ›": "ç‚¼æ°”9å±‚ï¼Œå³å°†ç­‘åŸº",
      "è£…å¤‡": "è·å¾—åˆçº§æ³•å®",
      "äººé™…å…³ç³»": "æ‘æ°‘çˆ±æˆ´ï¼Œè·å¾—æ¨èä¿¡"
    },
    "è·å¾—ç‰©å“": ["ç¥ç§˜ç‰ä½©", "åŸºç¡€åŠŸæ³•", "åˆçº§æ³•å®"],
    "å…³ç³»å˜åŒ–": ["ä¸æ‘æ°‘ç»“ç›Ÿ", "ä¸æ¶éœ¸é›†å›¢ç»“ä»‡"]
  }
}
```

#### 3.6.4 å•å…ƒè§„åˆ’ä¸ç« èŠ‚ç”Ÿæˆçš„å…³ç³»

**æ‰§è¡Œæµç¨‹**ï¼š
```
1. å…ˆç”Ÿæˆæ•´ä½“å¤§çº²ï¼ˆæ¡†æ¶ï¼‰
2. ç”ŸæˆåŸºç¡€å…ƒç´ ï¼ˆäººç‰©ã€ä¸–ç•Œè§‚ã€åŠŸæ³•ï¼‰
3. ã€æ–°å¢ã€‘ä¸ºæ¯ä¸ª100ç« å•å…ƒç”Ÿæˆè¯¦ç»†è§„åˆ’
   â”œâ”€â”€ å•å…ƒ1è§„åˆ’ï¼ˆç¬¬1-100ç« ï¼‰
   â”œâ”€â”€ å•å…ƒ2è§„åˆ’ï¼ˆç¬¬101-200ç« ï¼‰
   â””â”€â”€ ...ï¼ˆæŒ‰éœ€ç”Ÿæˆï¼‰
4. é€ç« ç”Ÿæˆå†…å®¹
   â”œâ”€â”€ ç¬¬1ç« ä¾èµ–äºï¼šå¤§çº² + å•å…ƒ1è§„åˆ’
   â”œâ”€â”€ ç¬¬2ç« ä¾èµ–äºï¼šå¤§çº² + å•å…ƒ1è§„åˆ’ + ç¬¬1ç« 
   â”œâ”€â”€ ...
   â”œâ”€â”€ ç¬¬101ç« ä¾èµ–äºï¼šå¤§çº² + å•å…ƒ2è§„åˆ’ + ç¬¬100ç« 
   â””â”€â”€ ...
```

**ç« èŠ‚ç”Ÿæˆæç¤ºè¯å¢å¼º**ï¼š
```
## ç¬¬50ç« åˆ›ä½œæŒ‡å¯¼

**æ‰€å±å•å…ƒ**ï¼šç¬¬1å•å…ƒ - åˆå…¥ä¿®ä»™è·¯ï¼ˆç¬¬1-100ç« ï¼‰
**å•å…ƒè¿›åº¦**ï¼š50%ï¼ˆä¸­ç‚¹ä½ç½®ï¼‰
**æ‰€å±ä¸‰å¹•**ï¼šç¬¬äºŒå¹• - å¯¹æŠ—ä¸å‘å±•
**ä¸–ç•Œå±‚çº§**ï¼šå‡¡ä¿—ç•Œ/æ–°æ‰‹æ‘
**ä¿®ä¸ºå¢ƒç•Œ**ï¼šç‚¼æ°”æœŸ5å±‚

**å¿…é¡»åŒ…å«çš„æ•…äº‹èŠ‚æ‹**ï¼š
- ä¸­ç‚¹è½¬æŠ˜ï¼šå‰§æƒ…å‘ç”Ÿé‡å¤§è½¬æŠ˜
- æ­ç¤ºéƒ¨åˆ†çœŸç›¸
- ä¸»è§’é¢ä¸´é‡è¦é€‰æ‹©

**æœ¬å•å…ƒç›¸å…³ä¼ç¬”**ï¼š
- ç¥ç§˜ç‰ä½©ï¼ˆå·²åŸ‹è®¾ï¼Œå³å°†æ­æ™“ï¼‰
- æ‘ä¸­è¯æï¼ˆå·²å›æ”¶ï¼‰

**å³å°†å‘ç”Ÿçš„å…³é”®äº‹ä»¶**ï¼š
- ç¬¬60ç« ï¼šå‡»è´¥ä¸­BOSSèµµå…­
- ç¬¬90ç« ï¼šä¸å¤§BOSSå†³æˆ˜

**å†™ä½œè¦æ±‚**ï¼ˆåŸºäºç¬¬äºŒå¹•ä¸­ç‚¹ï¼‰ï¼š
- å‰§æƒ…è¦æœ‰é‡å¤§è½¬æŠ˜
- æ­ç¤ºä¹‹å‰åŸ‹ä¸‹çš„ä¼ç¬”
- ä¸ºä¸»è§’çš„æˆé•¿é“ºå«
- åŠ å¿«èŠ‚å¥ï¼Œä¸ºç¬¬ä¸‰å¹•åšå‡†å¤‡
```

#### 3.6.5 æŠ€æœ¯å®ç°

**æ ¸å¿ƒç»„ä»¶**ï¼š
- `ModularStructurePlanner`: è§„åˆ’æ•´ä½“æ¨¡å—ç»“æ„
- `StoryUnitPlugin`: ç®¡ç†å•å…ƒè§„åˆ’æ•°æ®
- `StoryUnitPlan`: å•å…ƒè§„åˆ’æ•°æ®æ¨¡å‹

**æ–°å¢ä»»åŠ¡ç±»å‹**ï¼š
- `æ•…äº‹å•å…ƒè§„åˆ’`ï¼ˆStoryUnitPlanï¼‰: ä¸ºæ¯ä¸ª100ç« å•å…ƒåˆ›å»ºè¯¦ç»†è§„åˆ’

**ä»»åŠ¡ä¾èµ–**ï¼š
```
ç« èŠ‚å†…å®¹ä»»åŠ¡ä¾èµ–äºï¼š
- åŸºç¡€è®¾å®šï¼ˆå¤§çº²ã€äººç‰©ã€ä¸–ç•Œè§‚ç­‰ï¼‰
- æ‰€å±å•å…ƒè§„åˆ’ä»»åŠ¡
- å‰ä¸€ç« èŠ‚å†…å®¹
```

**æ’ä»¶åä½œ**ï¼š
- `StoryUnitPlugin` ä¸ `ForeshadowPlugin` åä½œï¼šå•å…ƒä¼ç¬”ç®¡ç†
- `StoryUnitPlugin` ä¸ `CharacterPlugin` åä½œï¼šå•å…ƒäººç‰©ä½“ç³»
- `StoryUnitPlugin` ä¸ `EventPlugin` åä½œï¼šå•å…ƒäº‹ä»¶è§„åˆ’

---

## å››ã€å‰ç«¯ç•Œé¢è®¾è®¡

### 4.1 è®¾è®¡ç†å¿µ

**ç¬¦åˆé•¿æœŸå†™å°è¯´çš„çœŸå®å·¥ä½œæµ**ï¼š
- æ¸…æ™°çš„è¿›åº¦æ¦‚è§ˆ
- ä¾¿æ·çš„å†…å®¹ç®¡ç†
- çµæ´»çš„æ–­ç‚¹ç»­å†™
- ç›´è§‚çš„è´¨é‡ç›‘æ§

### 4.2 é¡µé¢ç»“æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“š éƒ½å¸‚ä¿®ä»™äºŒåˆ›                              [ç»§ç»­] [æš‚åœ] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ€»è¿›åº¦: 30/100ç«   |  å·²å®Œæˆ: 28ç«   |  å¾…å®¡æ ¸: 1ç«   |  å¾…å†™: 71ç«  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   å¯¼èˆªæ     â”‚  â”‚           ä¸»å·¥ä½œåŒº                   â”‚  â”‚
â”‚  â”‚             â”‚  â”‚                                      â”‚  â”‚
â”‚  â”‚ ğŸ“‹ æ¦‚è§ˆ     â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚ ğŸ“ å¤§çº²     â”‚  â”‚  â”‚        ç¬¬30ç« ï¼šé­”é—¨è°ˆåˆ¤         â”‚  â”‚  â”‚
â”‚  â”‚ ğŸ‘¥ äººç‰©     â”‚  â”‚  â”‚  çŠ¶æ€: âŒ è´¨é‡æœªé€šè¿‡ (65åˆ†)     â”‚  â”‚  â”‚
â”‚  â”‚ ğŸ¯ é—¨æ´¾     â”‚  â”‚  â”‚  [é‡æ–°ç”Ÿæˆ] [æŸ¥çœ‹å†å²] [äººå·¥ç¼–è¾‘] â”‚  â”‚  â”‚
â”‚  â”‚ ğŸ”® ä¼ç¬”     â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚ âš¡ äº‹ä»¶     â”‚  â”‚                                      â”‚  â”‚
â”‚  â”‚ ğŸ“– ç« èŠ‚     â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚ âš™ï¸ è®¾ç½®     â”‚  â”‚  â”‚        ç¬¬31ç« ï¼š...              â”‚  â”‚  â”‚
â”‚  â”‚             â”‚  â”‚  â”‚  çŠ¶æ€: â³ å¾…ç”Ÿæˆ                â”‚  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚                  â”‚                                      â”‚  â”‚
â”‚                  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚                  â”‚  â”‚        ç¬¬32ç« ï¼š...              â”‚  â”‚  â”‚
â”‚                  â”‚  â”‚  çŠ¶æ€: â³ å¾…ç”Ÿæˆ                â”‚  â”‚  â”‚
â”‚                  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚                  â”‚                                      â”‚  â”‚
â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.3 æ ¸å¿ƒé¡µé¢

#### 4.3.1 æ¦‚è§ˆé¡µï¼ˆDashboardï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“Š é¡¹ç›®æ¦‚è§ˆ                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                               â”‚
â”‚  ğŸ“ˆ è¿›åº¦ç»Ÿè®¡                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  æ€»ç« èŠ‚æ•°: 100ç«                                      â”‚   â”‚
â”‚  â”‚  å·²å®Œæˆ: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 28ç«  (28%)            â”‚   â”‚
â”‚  â”‚  è¿›è¡Œä¸­: â–ˆâ–ˆâ–ˆâ–ˆ 1ç«                                     â”‚   â”‚
â”‚  â”‚  å¾…å®¡æ ¸: â–ˆâ–ˆ 1ç«  (è´¨é‡æœªé€šè¿‡)                         â”‚   â”‚
â”‚  â”‚  å¾…ç”Ÿæˆ: â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 70ç«                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                               â”‚
â”‚  ğŸ¯ è´¨é‡æ¦‚è§ˆ                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  å¹³å‡åˆ†: 78åˆ†                                        â”‚   â”‚
â”‚  â”‚  æœ€é«˜åˆ†: 92åˆ† (ç¬¬15ç« )                               â”‚   â”‚
â”‚  â”‚  æœ€ä½åˆ†: 65åˆ† (ç¬¬30ç«  - å¾…å®¡æ ¸)                      â”‚   â”‚
â”‚  â”‚  é‡å†™æ¬¡æ•°: 5æ¬¡                                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                               â”‚
â”‚  âš ï¸  å¾…å¤„ç†é—®é¢˜                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â€¢ ç¬¬30ç« : è´¨é‡æœªé€šè¿‡ (65åˆ†) - éœ€è¦äººå·¥å®¡æ ¸æˆ–é‡å†™    â”‚   â”‚
â”‚  â”‚  â€¢ ä¼ç¬”æ£€æŸ¥: æœ‰3ä¸ªä¼ç¬”æ¥è¿‘å›æ”¶æœŸé™ï¼Œå°šæœªå®‰æ’         â”‚   â”‚
â”‚  â”‚  â€¢ äººç‰©ä¸€è‡´æ€§: "å¼ ä¸‰"çš„æ€§æ ¼åœ¨ç¬¬20-25ç« æœ‰æ³¢åŠ¨         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                               â”‚
â”‚  [ğŸš€ ç»§ç»­ç”Ÿæˆ]  [â¸ï¸ æš‚åœ]  [ğŸ“Š æŸ¥çœ‹è¯¦ç»†æŠ¥å‘Š]               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.3.2 ç« èŠ‚åˆ—è¡¨é¡µ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“– ç« èŠ‚ç®¡ç†                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                               â”‚
â”‚  ç­›é€‰: [å…¨éƒ¨] [å·²å®Œæˆ] [è¿›è¡Œä¸­] [å¾…å®¡æ ¸] [å¾…ç”Ÿæˆ]            â”‚
â”‚  æ’åº: [ç« èŠ‚å·] [è´¨é‡åˆ†æ•°] [åˆ›å»ºæ—¶é—´]                        â”‚
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ç¬¬1ç«   ç©¿è¶Š        âœ… 85åˆ†  2026-01-28  [æŸ¥çœ‹] [ç¼–è¾‘]â”‚  â”‚
â”‚  â”‚ ç¬¬2ç«   å…¥é—¨        âœ… 82åˆ†  2026-01-28  [æŸ¥çœ‹] [ç¼–è¾‘]â”‚  â”‚
â”‚  â”‚ ...                                                     â”‚  â”‚
â”‚  â”‚ ç¬¬28ç«  é•¿è€çš„å˜±æ‰˜   âœ… 88åˆ†  2026-01-29  [æŸ¥çœ‹] [ç¼–è¾‘]â”‚  â”‚
â”‚  â”‚ ç¬¬29ç«  åˆ°è¾¾é­”é—¨     âœ… 80åˆ†  2026-01-29  [æŸ¥çœ‹] [ç¼–è¾‘]â”‚  â”‚
â”‚  â”‚ ç¬¬30ç«  é­”é—¨è°ˆåˆ¤    âŒ 65åˆ†  2026-01-29  [é‡å†™] [æŸ¥çœ‹]â”‚  â”‚
â”‚  â”‚                           â†’ é—®é¢˜: æ–‡ç¬”å¾…æå‡           â”‚  â”‚
â”‚  â”‚ ç¬¬31ç«  ...          â³ -    -          [ç”Ÿæˆ]        â”‚  â”‚
â”‚  â”‚ ç¬¬32ç«  ...          â³ -    -          [ç”Ÿæˆ]        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                               â”‚
â”‚  [æ‰¹é‡æ“ä½œ] [å¯¼å‡ºå…¨éƒ¨]                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.3.3 ç« èŠ‚è¯¦æƒ…é¡µ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç¬¬30ç« ï¼šé­”é—¨è°ˆåˆ¤                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                               â”‚
â”‚  åŸºæœ¬ä¿¡æ¯:                                                   â”‚
â”‚  â€¢ çŠ¶æ€: âŒ è´¨é‡æœªé€šè¿‡                                       â”‚
â”‚  â€¢ è´¨é‡åˆ†æ•°: 65/100                                          â”‚
â”‚  â€¢ åˆ›å»ºæ—¶é—´: 2026-01-29 10:10                               â”‚
â”‚  â€¢ é‡å†™æ¬¡æ•°: 3æ¬¡                                             â”‚
â”‚                                                               â”‚
â”‚  è´¨é‡è¯„åˆ†è¯¦æƒ…:                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  è¿è´¯æ€§: 70/100   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘               â”‚   â”‚
â”‚  â”‚  åˆ›æ„æ€§: 60/100   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘               â”‚   â”‚
â”‚  â”‚  è´¨é‡:   65/100   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘               â”‚   â”‚
â”‚  â”‚  ä¸€è‡´æ€§: 80/100   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ               â”‚   â”‚
â”‚  â”‚  ç›®æ ‡å¯¹é½: 50/100 â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                               â”‚
â”‚  è¯„ä¼°é—®é¢˜:                                                   â”‚
â”‚  â€¢ ç›®æ ‡å¯¹é½ä¸è¶³: è°ˆåˆ¤è¿‡ç¨‹ä¸å¤Ÿæ·±å…¥ï¼Œæœªè¾¾æˆæ˜ç¡®åè®®            â”‚
â”‚  â€¢ åˆ›æ„æ€§ä¸è¶³: å¯¹è¯è¾ƒä¸ºå¹³æ·¡ï¼Œç¼ºå°‘äº®ç‚¹                        â”‚
â”‚  â€¢ æ–‡ç¬”å¾…æå‡: éƒ¨åˆ†æå†™å¯ä»¥æ›´ç»†è‡´                            â”‚
â”‚                                                               â”‚
â”‚  ç‰ˆæœ¬å†å²:                                                   â”‚
â”‚  â€¢ v3 (å½“å‰) - 65åˆ† - [æŸ¥çœ‹]                                â”‚
â”‚  â€¢ v2 - 65åˆ† - [æŸ¥çœ‹] [æ¢å¤]                                â”‚
â”‚  â€¢ v1 - 60åˆ† - [æŸ¥çœ‹] [æ¢å¤]                                â”‚
â”‚                                                               â”‚
â”‚  [ğŸ”„ é‡æ–°ç”Ÿæˆ] [âœï¸ äººå·¥ç¼–è¾‘] [ğŸ“‹ æŸ¥çœ‹ä¸Šä¸‹æ–‡] [ğŸ“¤ å¯¼å‡º]       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ç« èŠ‚å†…å®¹:                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                     â”‚   â”‚
â”‚  â”‚  ï¼ˆå¯ç¼–è¾‘çš„æ–‡æœ¬åŒºåŸŸï¼‰                                â”‚   â”‚
â”‚  â”‚                                                     â”‚   â”‚
â”‚  â”‚  ææ˜ç«™åœ¨é­”é—¨çš„å±±é—¨å‰ï¼Œæ·±å¸äº†ä¸€å£æ°”...               â”‚   â”‚
â”‚  â”‚                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                               â”‚
â”‚  ä¸Šä¸‹æ–‡ä¿¡æ¯:                                                 â”‚
â”‚  â€¢ ç›¸å…³äººç‰©: ææ˜(ä¸»è§’)ã€ç‹é•¿è€ã€é­”é—¨é•¿è€                    â”‚
â”‚  â€¢ ç›¸å…³é—¨æ´¾: é’ç„å®—(å¸ˆé—¨)ã€é­”é—¨(æ•Œå¯¹)                       â”‚
â”‚  â€¢ ç›¸å…³ä¼ç¬”: [å›æ”¶] ç¬¬3ç« çš„é¢„è¨€                             â”‚
â”‚  â€¢ å‰ä¸€ç« : ç¬¬29ç«  - åˆ°è¾¾é­”é—¨                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.3.4 äººç‰©ç®¡ç†é¡µ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ‘¥ äººç‰©ç®¡ç†                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                               â”‚
â”‚  [+ æ–°å¢äººç‰©]  [æ‰¹é‡å¯¼å…¥]  [å¯¼å‡º]                            â”‚
â”‚                                                               â”‚
â”‚  ç­›é€‰: [å…¨éƒ¨] [ä¸»è§’] [é…è§’] [åæ´¾] [è·¯äºº]                   â”‚
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ææ˜ (ä¸»è§’)                          [ç¼–è¾‘] [åˆ é™¤]    â”‚  â”‚
â”‚  â”‚ æ€§æ ¼: åšéŸ§ã€é‡æƒ…ã€æ™ºå‹‡åŒå…¨                            â”‚  â”‚
â”‚  â”‚ ç›®æ ‡: æˆä¸ºä¿®ä»™ç•Œæœ€å¼ºï¼Œä¿æŠ¤æ‰€çˆ±ä¹‹äºº                    â”‚  â”‚
â”‚  â”‚ æˆé•¿å¼§å…‰: 3ä¸ªé˜¶æ®µ                                     â”‚  â”‚
â”‚  â”‚ å‡ºç°åœºæ¬¡: 30ç«                                         â”‚  â”‚
â”‚  â”‚                                                       â”‚  â”‚
â”‚  â”‚ å¼ ä¸‰ (ä¸»è§’å›¢)                        [ç¼–è¾‘] [åˆ é™¤]    â”‚  â”‚
â”‚  â”‚ æ€§æ ¼: å¿ è¯šã€ç›´çˆ½                                      â”‚  â”‚
â”‚  â”‚ ä½œç”¨: æ­¦åŠ›æ‹…å½“                                        â”‚  â”‚
â”‚  â”‚ å‡ºç°åœºæ¬¡: 25ç«                                         â”‚  â”‚
â”‚  â”‚                                                       â”‚  â”‚
â”‚  â”‚ ...                                                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.3.5 ä¼ç¬”è¿½è¸ªé¡µ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ”® ä¼ç¬”è¿½è¸ª                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                               â”‚
â”‚  [+ æ–°å¢ä¼ç¬”]  [è‡ªåŠ¨æ£€æŸ¥]                                     â”‚
â”‚                                                               â”‚
â”‚  ç­›é€‰: [å…¨éƒ¨] [å·²åŸ‹è®¾] [å·²å›æ”¶] [æœªå›æ”¶] [å·²è¿‡æœŸ]            â”‚
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ â³ æœªå›æ”¶ (8ä¸ª)                                        â”‚  â”‚
â”‚  â”‚                                                       â”‚  â”‚
â”‚  â”‚ â€¢ ç¥ç§˜é¡¹é“¾ (é‡è¦)                                     â”‚  â”‚
â”‚  â”‚   åŸ‹è®¾: ç¬¬5ç«    é¢„è®¡å›æ”¶: ç¬¬50ç«                       â”‚  â”‚
â”‚  â”‚   çŠ¶æ€: å·²åŸ‹è®¾ âœ…                                      â”‚  â”‚
â”‚  â”‚   [æŸ¥çœ‹è¯¦æƒ…] [ç¼–è¾‘å›æ”¶ç« èŠ‚]                           â”‚  â”‚
â”‚  â”‚                                                       â”‚  â”‚
â”‚  â”‚ â€¢ é•¿è€çš„ç§˜å¯† (å…³é”®)                                   â”‚  â”‚
â”‚  â”‚   åŸ‹è®¾: ç¬¬10ç«   é¢„è®¡å›æ”¶: ç¬¬60ç«                       â”‚  â”‚
â”‚  â”‚   çŠ¶æ€: å·²åŸ‹è®¾ âœ…                                      â”‚  â”‚
â”‚  â”‚                                                       â”‚  â”‚
â”‚  â”‚ â€¢ é¢„è¨€ä¸­çš„å‹‡è€… (å…³é”®)                                 â”‚  â”‚
â”‚  â”‚   åŸ‹è®¾: ç¬¬3ç«    é¢„è®¡å›æ”¶: ç¬¬30ç«  âš ï¸ å³å°†åˆ°æœŸ         â”‚  â”‚
â”‚  â”‚   çŠ¶æ€: å·²åŸ‹è®¾ âœ…                                      â”‚  â”‚
â”‚  â”‚                                                       â”‚  â”‚
â”‚  â”‚ âœ… å·²å›æ”¶ (15ä¸ª)                                       â”‚  â”‚
â”‚  â”‚ â€¢ å¸ˆçˆ¶çš„çœŸå®èº«ä»½ - å›æ”¶äºç¬¬25ç«  âœ“                     â”‚  â”‚
â”‚  â”‚                                                       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                               â”‚
â”‚  âš ï¸ è­¦å‘Š:                                                    â”‚
â”‚  â€¢ æœ‰1ä¸ªä¼ç¬”å³å°†åˆ°è¾¾é¢„è®¡å›æ”¶ç« èŠ‚ï¼Œè¯·ç¡®è®¤æ˜¯å¦å·²å®‰æ’          â”‚
â”‚  â€¢ æœ‰2ä¸ªä¼ç¬”å·²è¶…è¿‡é¢„è®¡å›æ”¶ç« èŠ‚5ç« ä»¥ä¸Šï¼Œè¯·å°½å¿«å®‰æ’           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.4 å…³é”®äº¤äº’æµç¨‹

#### 4.4.1 é¦–æ¬¡åˆ›å»ºé¡¹ç›®

```
1. ç”¨æˆ·ç‚¹å‡»"æ–°å»ºé¡¹ç›®"
   â†“
2. å¡«å†™é¡¹ç›®ä¿¡æ¯
   - é¡¹ç›®åç§°: "éƒ½å¸‚ä¿®ä»™äºŒåˆ›"
   - åŸä½œåç§°: "æˆ‘åœ¨éƒ½å¸‚ä¿®ä»™ï¼Œå¤ªç²¾å½©äº†"
   - æ€»ç« èŠ‚æ•°: 100
   - åˆ›ä½œæ¨¡å¼: [äºŒåˆ›æ¨¡å¼] [åŸåˆ›æ¨¡å¼]
   â†“
3. é€‰æ‹©äºŒåˆ›é…ç½®
   - ä¿ç•™å…ƒç´ : [ä¿®ä»™ä½“ç³»] [ä¸»è¦é—¨æ´¾] [æ ¸å¿ƒäººç‰©]
   - åè½¬å…ƒç´ : [ä¸»è§’èº«ä»½] [ç»“å±€èµ°å‘]
   - æ–°å¢å…ƒç´ : [æ–°é—¨æ´¾] [æ–°äººç‰©] [æ–°ä¼ç¬”]
   â†“
4. ç¡®è®¤åˆ›å»º
   â†“
5. è‡ªåŠ¨ç”Ÿæˆä»»åŠ¡æµç¨‹
   - è·³è¿‡"åˆ›æ„è„‘æš´"
   - ä»"é£æ ¼å…ƒç´ "å¼€å§‹
```

#### 4.4.2 ç»§ç»­å†™ä½œ

```
1. ç”¨æˆ·æ‰“å¼€é¡¹ç›®
   â†“
2. æ˜¾ç¤º"ç»§ç»­ä¸Šæ¬¡çš„å·¥ä½œ"
   - å½“å‰è¿›åº¦: ç¬¬30ç« 
   - çŠ¶æ€: è´¨é‡æœªé€šè¿‡ï¼Œç­‰å¾…å¤„ç†
   â†“
3. ç”¨æˆ·é€‰æ‹©æ“ä½œ
   A. é‡æ–°ç”Ÿæˆç¬¬30ç« 
   B. äººå·¥ç¼–è¾‘ç¬¬30ç« 
   C. è·³è¿‡ç¬¬30ç« ï¼Œç»§ç»­å†™ç¬¬31ç« 
   â†“
4. æ‰§è¡Œå¯¹åº”æ“ä½œ
```

#### 4.4.3 å•ç« é‡å†™

```
1. ç”¨æˆ·åœ¨ç« èŠ‚åˆ—è¡¨ç‚¹å‡»"é‡å†™"
   â†“
2. æ˜¾ç¤ºé‡å†™å¯¹è¯æ¡†
   - ç¡®è®¤è¦é‡å†™ç¬¬30ç« å—ï¼Ÿ
   - å½“å‰ç‰ˆæœ¬å°†ä¿å­˜åˆ°å†å²è®°å½•
   - é‡å†™å°†è‡ªåŠ¨æ³¨å…¥å®Œæ•´çš„ä¸Šä¸‹æ–‡
   â†“
3. ç”¨æˆ·ç¡®è®¤
   â†“
4. ç³»ç»Ÿæ‰§è¡Œé‡å†™
   - åŠ è½½ä¸Šä¸‹æ–‡
   - è°ƒç”¨LLMç”Ÿæˆ
   - è´¨é‡è¯„ä¼°
   â†“
5. æ˜¾ç¤ºç»“æœ
   - å¦‚æœé€šè¿‡: âœ… ä¿å­˜æ–°ç‰ˆæœ¬
   - å¦‚æœå¤±è´¥: âŒ æ˜¾ç¤ºé—®é¢˜ï¼Œå¯ç»§ç»­é‡å†™
```

---

## äº”ã€æŠ€æœ¯å®ç°è¦ç‚¹

### 5.1 åç«¯æ”¹é€ 

#### 5.1.1 ä»»åŠ¡æµç¨‹è°ƒæ•´

```python
# æ·»åŠ "äºŒåˆ›æ¨¡å¼"æ ‡å¿—
class SessionConfig:
    mode: str  # "original" | "derivative"

# äºŒåˆ›æ¨¡å¼è·³è¿‡è„‘æš´
if config.mode == "derivative":
    # ä»"é£æ ¼å…ƒç´ "å¼€å§‹ï¼Œè·³è¿‡"åˆ›æ„è„‘æš´"
    initial_tasks = ["é£æ ¼å…ƒç´ ", "ä¸»é¢˜ç¡®è®¤", "å¸‚åœºå®šä½"]
else:
    initial_tasks = ["åˆ›æ„è„‘æš´", "é£æ ¼å…ƒç´ ", ...]
```

#### 5.1.2 è´¨é‡é‡å†™æœºåˆ¶

```python
class LoopEngine:
    async def _execute_with_rewrite(self, task, context):
        max_rewrites = 3
        best_content = None
        best_score = 0

        for attempt in range(max_rewrites):
            content = await self._generate_content(task, context)
            result = await self.evaluator.evaluate(...)

            if result.score >= 70:
                # é€šè¿‡
                await self._save_content(task, content, result)
                return {"status": "success", "content": content}

            # ä¿ç•™æœ€å¥½çš„ç‰ˆæœ¬
            if result.score > best_score:
                best_content = content
                best_score = result.score

            if attempt < max_rewrites - 1:
                # é‡å†™ï¼Œå¸¦ä¸Šåé¦ˆ
                context["feedback"] = result.issues

        # 3æ¬¡éƒ½ä¸é€šè¿‡
        await self._save_content(task, best_content, result, status="failed")
        return {
            "status": "failed",
            "content": best_content,
            "score": best_score,
            "issues": result.issues
        }
```

#### 5.1.3 æ–­ç‚¹ç»­å†™

```python
class LoopEngine:
    async def pause(self):
        """æš‚åœæ‰§è¡Œå¹¶ä¿å­˜çŠ¶æ€"""
        # 1. ä¿å­˜å½“å‰ä»»åŠ¡çŠ¶æ€
        await self.session_storage.update_task_status(
            self.session_id,
            self.current_task.task_id,
            "paused"
        )

        # 2. ä¿å­˜æ‰€æœ‰æ’ä»¶çŠ¶æ€
        await self.plugin_manager.finalize_all(self.context)

        # 3. æ›´æ–°ä¼šè¯çŠ¶æ€
        await self.session_storage.update_session_status(
            self.session_id,
            SessionStatus.PAUSED
        )

        self.is_paused = True

    async def resume(self):
        """ä»æ–­ç‚¹æ¢å¤"""
        # 1. åŠ è½½ä¼šè¯çŠ¶æ€
        session = await self.session_storage.load_session(self.session_id)

        # 2. æ¢å¤æ’ä»¶çŠ¶æ€
        for plugin_name, plugin_data in session.plugin_states.items():
            plugin = self.plugin_manager.get(plugin_name)
            await plugin.restore_state(plugin_data)

        # 3. æ¢å¤ä»»åŠ¡é˜Ÿåˆ—
        self.task_queue = session.pending_tasks

        self.is_paused = False
        await self.run()
```

#### 5.1.4 å•ç« é‡å†™

```python
class LoopEngine:
    async def rewrite_chapter(self, chapter_index: int):
        """é‡å†™æŒ‡å®šç« èŠ‚"""
        # 1. åŠ è½½ç« èŠ‚çš„ä¸Šä¸‹æ–‡
        context = await self._load_chapter_context(chapter_index)

        # 2. æ¸…ç©ºå½“å‰å†…å®¹ï¼ˆä¿å­˜åˆ°å†å²ï¼‰
        await self._archive_current_version(chapter_index)

        # 3. é‡æ–°ç”Ÿæˆ
        result = await self._execute_with_rewrite(task, context)

        # 4. ä¿å­˜æ–°ç‰ˆæœ¬
        await self._save_chapter(chapter_index, result)

        return result
```

### 5.2 å‰ç«¯æ”¹é€ 

#### 5.2.1 APIç«¯ç‚¹

```python
# æ–°å¢APIç«¯ç‚¹
@router.post("/projects/{project_id}/continue")
async def continue_writing(project_id: str):
    """ç»§ç»­å†™ä½œ"""

@router.post("/projects/{project_id}/pause")
async def pause_writing(project_id: str):
    """æš‚åœå†™ä½œ"""

@router.post("/projects/{project_id}/chapters/{chapter_index}/rewrite")
async def rewrite_chapter(project_id: str, chapter_index: int):
    """é‡å†™æŒ‡å®šç« èŠ‚"""

@router.get("/projects/{project_id}/chapters/{chapter_index}/history")
async def get_chapter_history(project_id: str, chapter_index: int):
    """è·å–ç« èŠ‚å†å²ç‰ˆæœ¬"""

@router.post("/projects/{project_id}/chapters/{chapter_index}/restore")
async def restore_version(project_id: str, chapter_index: int, version: str):
    """æ¢å¤åˆ°æŒ‡å®šç‰ˆæœ¬"""
```

#### 5.2.2 WebSocketäº‹ä»¶

```python
# æ–°å¢WebSocketäº‹ä»¶
{
    "event": "chapter_progress",
    "data": {
        "chapter_index": 30,
        "status": "generating",
        "progress": 0.5
    }
}

{
    "event": "chapter_completed",
    "data": {
        "chapter_index": 30,
        "status": "success" | "failed",
        "score": 85,
        "content": "..."
    }
}

{
    "event": "rewrite_attempt",
    "data": {
        "chapter_index": 30,
        "attempt": 2,
        "score": 72,
        "issues": [...]
    }
}
```

### 5.3 æ•°æ®åº“è®¾è®¡

#### 5.3.1 ç« èŠ‚è¡¨æ‰©å±•

```python
class ChapterModel(Base):
    __tablename__ = "chapters"

    id = Column(Integer, primary_key=True)
    session_id = Column(String, ForeignKey("sessions.id"))
    chapter_index = Column(Integer)

    # å†…å®¹
    content = Column(Text)
    current_version = Column(String, default="v1")

    # çŠ¶æ€
    status = Column(Enum("pending", "generating", "completed", "failed"))
    score = Column(Float)
    issues = Column(JSON)  # è¯„ä¼°é—®é¢˜åˆ—è¡¨

    # ç‰ˆæœ¬å†å²
    version_history = Column(JSON)  # {v1: {...}, v2: {...}}

    # å…ƒæ•°æ®
    metadata = Column(JSON)  # {ç›®æ ‡ã€ä¸Šä¸‹æ–‡ã€...}

    created_at = Column(DateTime)
    updated_at = Column(DateTime)
```

#### 5.3.2 ä¼šè¯çŠ¶æ€æ‰©å±•

```python
class SessionModel(Base):
    # ... ç°æœ‰å­—æ®µ ...

    # æ–°å¢å­—æ®µ
    mode = Column(String)  # "original" | "derivative"
    current_chapter = Column(Integer, default=0)
    total_chapters = Column(Integer)
    status = Column(Enum("running", "paused", "completed"))
    plugin_states = Column(JSON)  # æ’ä»¶çŠ¶æ€å¿«ç…§
    task_queue = Column(JSON)  # å¾…æ‰§è¡Œä»»åŠ¡é˜Ÿåˆ—
```

---

## å…­ã€å®æ–½è®¡åˆ’

### 6.1 å¼€å‘é˜¶æ®µ

| é˜¶æ®µ | ä»»åŠ¡ | ä¼˜å…ˆçº§ | å·¥ä½œé‡ |
|------|------|--------|--------|
| P0 | æ–­ç‚¹ç»­å†™åŠŸèƒ½ | é«˜ | 2å¤© |
| P0 | è´¨é‡é‡å†™æœºåˆ¶ | é«˜ | 2å¤© |
| P0 | å•ç« é‡å†™åŠŸèƒ½ | é«˜ | 1å¤© |
| P1 | å‰ç«¯æ¦‚è§ˆé¡µ | é«˜ | 2å¤© |
| P1 | å‰ç«¯ç« èŠ‚åˆ—è¡¨ | é«˜ | 2å¤© |
| P1 | å‰ç«¯ç« èŠ‚è¯¦æƒ… | é«˜ | 2å¤© |
| P2 | å‰ç«¯äººç‰©ç®¡ç† | ä¸­ | 1å¤© |
| P2 | å‰ç«¯ä¼ç¬”è¿½è¸ª | ä¸­ | 1å¤© |
| P2 | äºŒåˆ›æ¨¡å¼æµç¨‹ | ä¸­ | 1å¤© |

### 6.2 æµ‹è¯•è®¡åˆ’

| æµ‹è¯•å†…å®¹ | æµ‹è¯•åœºæ™¯ | é¢„æœŸç»“æœ |
|---------|---------|---------|
| æ–­ç‚¹ç»­å†™ | å†™åˆ°ç¬¬30ç« æ—¶æš‚åœï¼Œå…³é—­æµè§ˆå™¨ï¼Œé‡æ–°æ‰“å¼€ç»§ç»­ | ä»ç¬¬31ç« ç»§ç»­ï¼Œä¸Šä¸‹æ–‡å®Œæ•´ |
| è´¨é‡é‡å†™ | ç”Ÿæˆç« èŠ‚ä¸é€šè¿‡ï¼Œè‡ªåŠ¨é‡å†™3æ¬¡ | ä¿ç•™æœ€é«˜åˆ†ç‰ˆæœ¬ï¼Œæ ‡è®°å¤±è´¥ |
| å•ç« é‡å†™ | æ‰‹åŠ¨è§¦å‘é‡å†™ç¬¬30ç«  | ç”Ÿæˆæ–°ç‰ˆæœ¬ï¼Œå†å²ç‰ˆæœ¬å¯æŸ¥çœ‹ |
| ä¸€è‡´æ€§ | å†™ç¬¬50ç« ï¼Œä¿®æ”¹ç¬¬10ç« çš„äººç‰©æ€§æ ¼ | ç³»ç»Ÿè­¦å‘Šä¸ä¸€è‡´ |
| ä¼ç¬”è¿½è¸ª | ç¬¬30ç« åº”è¯¥å›æ”¶ç¬¬5ç« ä¼ç¬”ï¼Œä½†æ²¡å†™ | ç³»ç»Ÿæç¤ºä¼ç¬”é—æ¼ |

---

## ä¸ƒã€é£é™©è¯„ä¼°

| é£é™© | å½±å“ | ç¼“è§£æªæ–½ |
|------|------|---------|
| ä¸Šä¸‹æ–‡ä¸¢å¤±å¯¼è‡´ä¸ä¸€è‡´ | é«˜ | å®šæœŸä¿å­˜çŠ¶æ€ï¼Œå®Œæ•´åŠ è½½æ’ä»¶æ•°æ® |
| è´¨é‡è¯„ä¼°ä¸å‡†ç¡® | ä¸­ | è°ƒæ•´è¯„ä¼°ç»´åº¦å’Œæƒé‡ï¼Œäººå·¥å®¡æ ¸æœºåˆ¶ |
| é‡å†™æ¬¡æ•°è¿‡å¤šå¯¼è‡´æˆæœ¬é«˜ | ä¸­ | é™åˆ¶é‡å†™æ¬¡æ•°ï¼Œæä¾›äººå·¥ç¼–è¾‘å…¥å£ |
| å‰ç«¯ä½“éªŒä¸ä½³ | ä¸­ | è¿­ä»£ä¼˜åŒ–ï¼Œå‚è€ƒä¸“ä¸šå†™ä½œå·¥å…· |

---

## å…«ã€æ€»ç»“

æœ¬æ–¹æ¡ˆé€šè¿‡**æ¸è¿›å¼æ„å»º**ã€**ç³»ç»Ÿä¿è¯è´¨é‡**ã€**éšæ—¶æ–­ç‚¹ç»­å†™**ä¸‰å¤§æœºåˆ¶ï¼Œè§£å†³äº†é•¿ç¯‡å°è¯´åˆ›ä½œçš„æ ¸å¿ƒç—›ç‚¹ï¼š

1. **å¤æ‚è®¾å®šç®¡ç†**ï¼šå¤§çº²ç˜¦èº« + æ’ä»¶ç‹¬ç«‹ç®¡ç†
2. **ä¸Šä¸‹æ–‡è¡”æ¥**ï¼šä¸‰å±‚æœºåˆ¶ï¼ˆä»»åŠ¡ä¾èµ– + æ’ä»¶å¢å¼º + å‘é‡æ£€ç´¢ï¼‰
3. **è´¨é‡ä¿è¯**ï¼šå¤šç»´åº¦è¯„ä¼° + è‡ªåŠ¨é‡å†™ + ä¸€è‡´æ€§éªŒè¯
4. **æ–­ç‚¹ç»­å†™**ï¼šå®Œæ•´çŠ¶æ€ä¿å­˜ + éšæ—¶æ¢å¤
5. **å•ç« é‡å†™**ï¼šå†å²ç‰ˆæœ¬ç®¡ç† + è‡ªåŠ¨æ³¨å…¥ä¸Šä¸‹æ–‡

é…åˆç¬¦åˆçœŸå®å·¥ä½œæµçš„å‰ç«¯ç•Œé¢ï¼Œè®©ä½œè€…å¯ä»¥ä¸“æ³¨äºåˆ›æ„ï¼ŒæŠŠå¤æ‚åº¦äº¤ç»™ç³»ç»Ÿå¤„ç†ã€‚
